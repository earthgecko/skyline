

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Upgrading &mdash; Skyline 1.1.11-stable documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/skyline.styles.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Skyline 1.1.11-stable documentation" href="../index.html"/>
        <link rel="next" title="Upgrading - Crucible to Ionosphere" href="crucible-to-ionosphere.html"/>
        <link rel="prev" title="Installation" href="../installation.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Skyline
          

          
          </a>

          
            
            
              <div class="version">
                1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../requirements.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running-in-python-virtualenv.html">Running Skyline in a Python virtualenv</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Upgrading</a><ul>
<li class="toctree-l2"><a class="reference internal" href="crucible-to-ionosphere.html">Upgrading - Crucible to Ionosphere</a></li>
<li class="toctree-l2"><a class="reference internal" href="etsy-to-ionosphere.html">Upgrading - Etsy to Ionosphere</a></li>
<li class="toctree-l2"><a class="reference internal" href="etsy-to-crucible.html">Upgrading - Etsy to Crucible</a></li>
<li class="toctree-l2"><a class="reference internal" href="#backup-your-redis">Backup your Redis!</a></li>
<li class="toctree-l2"><a class="reference internal" href="#upgrading-from-the-etsy-version-of-skyline">Upgrading from the Etsy version of Skyline</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#do-a-new-install">Do a new install</a></li>
<li class="toctree-l3"><a class="reference internal" href="#things-to-note">Things to note</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#directory-structure-changes">Directory structure changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#settings-py">settings.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="#analyzer-optimizations">Analyzer optimizations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#skyline-graphite-namespace-for-metrics">Skyline graphite namespace for metrics</a></li>
<li class="toctree-l4"><a class="reference internal" href="#logging">Logging</a></li>
<li class="toctree-l4"><a class="reference internal" href="#new-required-components">New required components</a></li>
<li class="toctree-l4"><a class="reference internal" href="#clone-and-have-a-look">Clone and have a look</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../getting-data-into-skyline.html">Getting data into Skyline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../alert-testing.html">Alert testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../monotonic-metrics.html">Strictly increasing monotonicity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../horizon.html">Horizon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analyzer.html">Analyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analyzer-optimizations.html">Analyzer Optimizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mirage.html">Mirage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../boundary.html">Boundary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../crucible.html">Crucible</a></li>
<li class="toctree-l1"><a class="reference internal" href="../panorama.html">Panorama</a></li>
<li class="toctree-l1"><a class="reference internal" href="../webapp.html">Webapp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ionosphere.html">Ionosphere</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tsfresh.html">tsfresh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../redis-integration.html">Redis integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../skyline-and-friends.html">Skyline and friends</a></li>
<li class="toctree-l1"><a class="reference internal" href="../logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tuning-tips.html">Tuning tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tuning-tips.html#smaller-deployments">Smaller deployments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tuning-tips.html#reliability">Reliability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../monitoring-skyline.html">Monitoring Skyline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debian-and-vagrant-installation-tips.html">Debian and Vagrant Installation Tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whats-new.html">What's new</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../skyline.html">skyline package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Skyline</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>Upgrading</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/upgrading/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="upgrading">
<h1>Upgrading<a class="headerlink" href="#upgrading" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="crucible-to-ionosphere.html">Upgrading - Crucible to Ionosphere</a><ul>
<li class="toctree-l2"><a class="reference internal" href="crucible-to-ionosphere.html#new-settings-py-variables">New settings.py variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="crucible-to-ionosphere.html#modified-settings-py-docstrings">Modified settings.py docstrings</a></li>
<li class="toctree-l2"><a class="reference internal" href="crucible-to-ionosphere.html#clean-up-skyline-permissions">Clean up Skyline permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="crucible-to-ionosphere.html#update-your-mysql-skyline-database">Update your MySQL Skyline database</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="etsy-to-ionosphere.html">Upgrading - Etsy to Ionosphere</a><ul>
<li class="toctree-l2"><a class="reference internal" href="etsy-to-ionosphere.html#upgrade-steps">Upgrade steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="etsy-to-crucible.html">Upgrading - Etsy to Crucible</a><ul>
<li class="toctree-l2"><a class="reference internal" href="etsy-to-crucible.html#upgrade-steps">Upgrade steps</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="backup-your-redis">
<h2>Backup your Redis!<a class="headerlink" href="#backup-your-redis" title="Permalink to this headline">¶</a></h2>
<p>Do it.</p>
</div>
<div class="section" id="upgrading-from-the-etsy-version-of-skyline">
<h2>Upgrading from the Etsy version of Skyline<a class="headerlink" href="#upgrading-from-the-etsy-version-of-skyline" title="Permalink to this headline">¶</a></h2>
<p>This section covers the steps involved in upgrading an existing Skyline
implementation. For the sake of fullness this describes the changes from
the last
<a class="reference external" href="https://github.com/etsy/skyline/commit/22ae09da716267a65835472da89ac31cc5cc5192">github/etsy/skyline</a>
commit to date.</p>
<div class="section" id="do-a-new-install">
<h3>Do a new install<a class="headerlink" href="#do-a-new-install" title="Permalink to this headline">¶</a></h3>
<p>If you are upgrading from an Etsy version consider doing a new install, all you
need is your Redis data (but BACK IT UP FIRST)</p>
<p>However you may have some other monitoring or custom inits, etc set up on your
Skyline then the below is a best effort guide.</p>
</div>
<div class="section" id="things-to-note">
<h3>Things to note<a class="headerlink" href="#things-to-note" title="Permalink to this headline">¶</a></h3>
<p>This new version of Skyline sees a lot of changes, however although
certain things have changed and much has been added, whether these
changes are backwards incompatible in terms of functionality is
debatable. That said, there is a lot of change.  Please review the following
key changes relating to upgrading.</p>
<div class="section" id="directory-structure-changes">
<h4>Directory structure changes<a class="headerlink" href="#directory-structure-changes" title="Permalink to this headline">¶</a></h4>
<p>In order to bring Skyline in line with a more standard Python package
structure the directory structure has had to changed to accommodate
sphinx autodoc and the setuptools framework.</p>
</div>
<div class="section" id="settings-py">
<h4>settings.py<a class="headerlink" href="#settings-py" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal"><span class="pre">settings.py</span></code> has had a face lift too. This will probably be the
largest initial change that any users upgrading from Skyline &lt; 1.0.0
will find.</p>
<p>The format is much less friendly to the eye as it now has all the
comments in Python docstrings rather than just plain “#”ed lines.
Apologies for this, but for complete autodoc coverage and referencing it
is a necessary change.</p>
</div>
<div class="section" id="analyzer-optimizations">
<h4>Analyzer optimizations<a class="headerlink" href="#analyzer-optimizations" title="Permalink to this headline">¶</a></h4>
<p>There has been some fairly substantial performance improvements that may affect
your Analyzer settings.  The optimizations should benefit any deployment,
however they will benefit smaller Skyline deployments more than very large
Skyline deployments.  Finding the optimum settings for your Analyzer deployment
will require some evaluation of your Analyzer run_time, total_metrics and
<a class="reference internal" href="../skyline.html#settings.ANALYZER_PROCESSES" title="settings.ANALYZER_PROCESSES"><code class="xref py py-mod docutils literal"><span class="pre">settings.ANALYZER_PROCESSES</span></code></a>.</p>
<p>See <a class="reference external" href="../analyzer-optimizations.html">Analyzer Optimizations</a> and regardless of
whether your deployment is small or large the new
<a class="reference internal" href="../skyline.html#settings.RUN_OPTIMIZED_WORKFLOW" title="settings.RUN_OPTIMIZED_WORKFLOW"><code class="xref py py-mod docutils literal"><span class="pre">settings.RUN_OPTIMIZED_WORKFLOW</span></code></a> timeseries analysis will improve
performance and benefit all deployments.</p>
</div>
<div class="section" id="skyline-graphite-namespace-for-metrics">
<h4>Skyline graphite namespace for metrics<a class="headerlink" href="#skyline-graphite-namespace-for-metrics" title="Permalink to this headline">¶</a></h4>
<p>The original metrics namespace for skyline was <code class="docutils literal"><span class="pre">skyline.analyzer</span></code>,
<code class="docutils literal"><span class="pre">skyline.horizon</span></code>, etc. Skyline now shards metrics by the Skyline
server host name. So before you start the new Skyline apps when
referenced below in the Upgrade steps, ensure you move/copy your whisper
files related to Skyline to their new namespaces, which are
<code class="docutils literal"><span class="pre">skyline.&lt;hostname&gt;.analyzer</span></code>, <code class="docutils literal"><span class="pre">skyline.&lt;hostname&gt;.horizon</span></code>, etc. Or
use Graphite’s whisper-fill.py to populate the new metric namespaces
from the old ones.</p>
</div>
<div class="section" id="logging">
<h4>Logging<a class="headerlink" href="#logging" title="Permalink to this headline">¶</a></h4>
<p>There have been changes made in the logging methodology, see
<a class="reference external" href="../logging.html">Logging</a>.</p>
</div>
<div class="section" id="new-required-components">
<h4>New required components<a class="headerlink" href="#new-required-components" title="Permalink to this headline">¶</a></h4>
<p>MySQL and memcached.</p>
</div>
<div class="section" id="clone-and-have-a-look">
<h4>Clone and have a look<a class="headerlink" href="#clone-and-have-a-look" title="Permalink to this headline">¶</a></h4>
<p>If you are quite familiar with your Skyline setup it would be useful to
clone the new Skyline and first have a look at the new structure and
assess how this impacts any of your deployment patterns, init,
supervisord, etc and et al.  Diff the new settings.py and your existing
settings.py to see the additions and all the changes you need to make.</p>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="crucible-to-ionosphere.html" class="btn btn-neutral float-right" title="Upgrading - Crucible to Ionosphere" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../installation.html" class="btn btn-neutral" title="Installation" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013-2014, Etsy Inc; 2015, Abe Stanway; 2015-2018, Gary Wilson.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.1.11-stable',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>