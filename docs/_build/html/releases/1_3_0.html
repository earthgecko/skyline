

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1.3.0 &mdash; Skyline 2.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/skyline.styles.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="1.2.17" href="1_2_17.html" />
    <link rel="prev" title="1.3.1" href="1_3_1.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Skyline
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../requirements.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running-in-python-virtualenv.html">Running Skyline in a Python virtualenv</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../upgrading/index.html">Upgrading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-data-into-skyline.html">Getting data into Skyline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../alert-testing.html">Alert testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../alerts.html">Alerts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../slack.html">slack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../monotonic-metrics.html">Strictly increasing monotonicity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../horizon.html">Horizon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analyzer.html">Analyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analyzer-optimizations.html">Analyzer Optimizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../algorithms/index.html">Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mirage.html">Mirage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../boundary.html">Boundary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../crucible.html">Crucible</a></li>
<li class="toctree-l1"><a class="reference internal" href="../panorama.html">Panorama</a></li>
<li class="toctree-l1"><a class="reference internal" href="../webapp.html">Webapp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ionosphere.html">Ionosphere</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ionosphere_echo.html">Ionosphere echo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tsfresh.html">tsfresh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../luminosity.html">Luminosity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../flux.html">Flux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../upload-data-to-flux.html">upload_data to Flux - EXPERIMENTAL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vista.html">Vista</a></li>
<li class="toctree-l1"><a class="reference internal" href="../redis-integration.html">Redis integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rebrow.html"><span class="red">re</span><span class="brow">brow</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../running-multiple-skylines.html">Running multiple Skyline instances</a></li>
<li class="toctree-l1"><a class="reference internal" href="../skyline-and-friends.html">Skyline and friends</a></li>
<li class="toctree-l1"><a class="reference internal" href="../logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tuning-tips.html">Tuning tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="../monitoring-skyline.html">Monitoring Skyline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deprecated-docs/index.html">Deprecated docs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../releases.html">Release Notes</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1_3_1.html">1.3.1</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">1.3.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#changes-in-v1-3-0">Changes in v1.3.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="#update-notes">Update notes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#settings-py-changes">settings.py Changes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#how-to-update-from-v1-2-17">How to update from v1.2.17</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="1_2_17.html">1.2.17</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_16.html">1.2.16</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_15.html">1.2.15</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_14.html">1.2.14</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_13.html">1.2.13</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_12.html">1.2.12</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_11.html">1.2.11 - the luminosity branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_10.html">1.2.10 - the luminosity branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_9.html">1.2.9 - the luminosity branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_8.html">1.2.8 - the luminosity and dawn branches</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_7.html">1.2.7 - the luminosity branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_6.html">1.2.6 - the luminosity branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_5.html">1.2.5 - the luminosity branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_4.html">1.2.4 - the luminosity branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_3.html">1.2.3 - the luminosity branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_2.html">1.2.2 - the luminosity branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_1.html">1.2.1 - the luminosity branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_0.html">1.2.0 - the luminosity branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_11.html">1.1.11 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_10.html">1.1.10 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_9.html">1.1.9 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_8.html">1.1.8 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_7.html">1.1.7 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_6.html">1.1.6 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_5.html">1.1.5 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_4.html">1.1.4 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_3.html">1.1.3 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_2.html">1.1.2 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_1.html">1.1.1 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_0.html">1.1.0 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_8.html">1.0.8 - the crucible branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_7.html">1.0.7 - the crucible branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_6.html">1.0.6 - the crucible branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_5.html">1.0.5 - the crucible branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_4.html">1.0.4 - the crucible branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_3.html">1.0.3 - the crucible branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_2.html">1.0.2 - the crucible branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_1.html">1.0.1 - the crucible branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_0.html">1.0.0 - the crucible branch</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../whats-new.html">What’s new</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../skyline.html">skyline package</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Skyline</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../releases.html">Release Notes</a> &raquo;</li>
        
      <li>1.3.0</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/releases/1_3_0.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>1.3.0<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>v1.3.0 - September 25, 2019</p>
<p>This is a features functionality release with minor bug fixes.  This release
introduces a few new features and new functionality:</p>
<ul class="simple">
<li><p>A new Ionosphere feature related to validating matches.</p></li>
<li><p>The ability to run the Skyline stack on docker</p></li>
<li><p>Introduces Skyline Flux for receiving metrics via HTTP and submitting them to
Graphite.</p></li>
<li><p>Introduces Skyline Vista for fetching metrics from remote sources.</p></li>
</ul>
<p>Please see the new documentation pages for full details about each new addition.</p>
<div class="section" id="changes-in-v1-3-0">
<h2>Changes in v1.3.0<a class="headerlink" href="#changes-in-v1-3-0" title="Permalink to this headline">¶</a></h2>
<p>Lots of changes have been introduced to accommodate docker and the addition of
Flux and Vista.</p>
<ul class="simple">
<li><p>Use GRAPHITE_RENDER_URI and do not try to alert if the settings are default in
analyzer/alerters.py (3002)</p></li>
<li><p>Wrapped new get_graphite_render_uri and get_graphite_custom_headers functions
in try and except in analyzer/alerters.py (3002)</p></li>
<li><p>The management of the analyzer Redis algorithm exception sets was previously
handled a if settings.ENABLE_MIRAGE block.  This meant that if there are no
mirage metrics, the sets were not managed.  Added manage_analyzer_algorithm_exception_sets
in analyzer/analyzer.py to manage these sets in their own context. (3002, 3020)</p></li>
<li><p>Re-enabled the illuminance metric in analyzer (2580)</p></li>
<li><p>Declare and test if the derivative_metrics Redis set exists in analyzer so
that errors are not thrown if there are actually no derivative metrics (3002)</p></li>
<li><p>Use GRAPHITE_RENDER_URI and use new CARBON_HOST variable instead of
GRAPHITE_HOST in send_graphite_metric (3002)</p></li>
<li><p>Handle self signed certificate on Docker with requests (3002)</p></li>
<li><p>Handle when Skyline is first installed, if luminosity is enabled it reports
errors as there are no anomaly ids (3002, 3016)</p></li>
<li><p>Log appropriate to whether memcache is enabled or not (3002, 3016)</p></li>
<li><p>Handle self signed certificate on Docker with requests (3002)</p></li>
<li><p>Do not analyse short time series, only return a time series sample if the
sample has sufficient data points otherwise get_anomalies() will throw an
error (3002, 3008)</p></li>
<li><p>Added docker settings (3002)</p></li>
<li><p>Allow rebrow to connect to Redis on the socket too and if docker dsplay the
REDIS_PASSWORD in rebrow_login (3002)</p></li>
<li><p>Use GRAPHITE_RENDER_URI (3002)</p></li>
<li><p>Revert to original skyline.httpd.conf.d.example and added
skyline.docker.apache2.conf.d.example (3002)</p></li>
<li><p>Reformat print in analyzer/agent.py (3002)</p></li>
<li><p>When there are multiple channels declared Skyline only wants to update the
panorama.slack_thread_ts Redis key once for the primary Skyline channel, so if
the cache key exists do not update, analyzer/alerters.py (3110)</p></li>
<li><p>Added a hashlib hexdigest method which has not been verified so using the
original method useless the base_name is longer than 254 chars,
analyzer/alerters.py (3002)</p></li>
<li><p>Allow for DOCKER_FAKE_EMAIL_ALERTS and GRAPHITE_CUSTOM_HEADERS,
analyzer/alerters.py (3002)</p></li>
<li><p>Added get_graphite_port, get_graphite_render_uri and
get_graphite_custom_headers functions, analyzer/alerters.py (3002)</p></li>
<li><p>Reduce amount of Manager instances that are used as each requires a copy of
entire memory to be copied into each subprocess so this results in a python
process per Manager instance, using as much memory as the parent.  OK on a
server, not so much in a container.  Disabled all the Manager() lists and
replaced with Redis sets, analyzer/analyzer.py (3002, 3032, 3034)</p></li>
<li><p>Moved the interpolation of the MIRAGE_PERIODIC variables to the top of the
file out of spawn_process so they can be accessed in run too and check the
added mirage_periodic_check_keys list rather than checking each and every
metric name key, analyzer/analyzer.py (2882)</p></li>
<li><p>Disabled for now as in concept phase, analyzer/analyzer.py (2580)</p></li>
<li><p>The management of the analyzer Redis algorithm exception sets was previously
handled in an if settings.ENABLE_MIRAGE block This meant that if there are no
mirage metrics, the sets were not managed, analyzer/analyzer.py (3020)</p></li>
<li><p>Changes for docker, not complete or fully tested.</p></li>
<li><p>Reduce amount of Manager instances that are used as each requires a copy of
entire memory to be copied into each subprocess so this results in a python
process per Manager instance, using as much memory as the parent.  OK on a
server, not so much in a container.  Disabled all the Manager() lists and
replaced with Redis sets, boundary/boundary.py (3002, 3032, 3034)</p></li>
<li><p>Use GRAPHITE_RENDER_URI, boundary/boundary.py (3002)</p></li>
<li><p>Reduce amount of Manager instances that are used as each requires a copy of
entire memory to be copied into each subprocess so this results in a python
process per Manager instance, using as much memory as the parent.  OK on a
server, not so much in a container.  Disabled all the Manager() lists and
replaced with Redis sets, crucible/crucible.py (3002, 3032)</p></li>
<li><p>Add a crucible - skyline.consensus.anomalies.png to plot Skyline anomalies if
CONSENSUS is achieved and create file resources skyline.anomalies_score.txt
and skyline.anomalies.csv, crucible/crucible_algorithms.py (3106)</p></li>
<li><p>Reduce amount of Manager instances that are used as each requires a copy of
entire memory to be copied into each subprocess so this results in a python
process per Manager instance, using as much memory as the parent.  OK on a
server, not so much in a container.  Disabled all the Manager() lists and
replaced with Redis sets, skyline/ionosphere/ionosphere.py (3002, 3032)</p></li>
<li><p>Do not run checks if namespace has matched multiple times in the last 10
minutes.  However determining which Skyline related metrics are feeding back
are quite difficult to ascertain.  So use the ionosphere_busy logic again and
use or find the skyline host namespace and if busy do not analyse the Skyline
host namespace while ionosphere is busy related to SKYLINE_FEEDBACK_NAMESPACES,
skyline/ionosphere/ionosphere.py (3050)</p></li>
<li><p>Only process FULL_DURATION feature profiles if there is a
ionosphere.unique_metrics Redis set (2484)</p></li>
<li><p>Handle self signed certificate on Docker, skyline/ionosphere/learn.py (3002)</p></li>
<li><p>Reduce amount of Manager instances that are used as each requires a copy of
entire memory to be copied into each subprocess so this results in a python
process per Manager instance, using as much memory as the parent.  OK on a
server, not so much in a container.  Disabled all the Manager() lists and
replaced with Redis sets, skyline/luminosity/luminosity.py (3002, 3032)</p></li>
<li><p>When Skyline is first installed, if luminosity is enabled it reports errors as
there are no anomaly ids, skyline/luminosity/luminosity.py (3016)</p></li>
<li><p>Handle self signed certificate on Docker,
skyline/luminosity/process_correlations.py (3002)</p></li>
<li><p>Reduce amount of Manager instances that are used as each requires a copy of
entire memory to be copied into each subprocess so this results in a python
process per Manager instance, using as much memory as the parent.  OK on a
server, not so much in a container.  Disabled all the Manager() lists and
replaced with Redis sets, skyline/mirage/mirage.py (3002, 3032)</p></li>
<li><p>When there are multiple channels declared Skyline only wants to update the
panorama.slack_thread_ts Redis key once for the primary Skyline channel, so if
the cache key exists do not update, skyline/mirage/mirage_alerters.py (3110)</p></li>
<li><p>Reduce amount of Manager instances that are used as each requires a copy of
entire memory to be copied into each subprocess so this results in a python
process per Manager instance, using as much memory as the parent.  OK on a
server, not so much in a container.  Disabled all the Manager() lists and
replaced with Redis sets, skyline/mirage/mirage.py (3002, 3032)</p></li>
<li><p>Allow webapp to connect on reborw via socket if running on docker,
skyline/webapp/templates/rebrow_login.html (3002)</p></li>
<li><p>Handle self signed certificate on Docker, skyline/webapp/ionosphere_backend.py
(3190)</p></li>
<li><p>Handle if all features profiles have been disabled in the ionosphere_search
function, skyline/webapp/ionosphere_backend.py (3190)</p></li>
<li><p>Added Ionosphere - validated matches (3082, 3084)</p></li>
<li><p>Added metrics id to relevant web pages, skyline/webapp/webapp.py (2990)</p></li>
<li><p>Added docker related settings to settings.py (3002)</p></li>
<li><p>Added Ionosphere - validated matches DB changes to skyline.sql (3084)</p></li>
<li><p>Added docker changes and some Pyton 3.7 testing changes to
skyline/skyline_functions.py (3002, 2828)</p></li>
<li><p>Updated version and branch in skyline/skyline_version.py (3002)</p></li>
<li><p>Updated to 1.3.0 - skyline/utils/dawn/skyline.dawn.sh (3002)</p></li>
<li><p>Uppdated dependencies</p></li>
<li><p>skyline.dawn.sh changes related to docker (3002)</p></li>
<li><p>Update version and dependencies</p></li>
<li><p>Added a users tables to the DB to allow to map user to actions, labels, etc
(3230, 2476, 2516)</p></li>
</ul>
</div>
<div class="section" id="update-notes">
<h2>Update notes<a class="headerlink" href="#update-notes" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>These update instruction apply to upgrading from v1.2.17 to v1.3.0 only.
However as with all Skyline updates it is possible to go through the update
notes for each version and make your own update notes/process to take you from
version x to version y.</p></li>
<li><p>There are changes to the DB in v1.3.0</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is assumed that the database is not running with an offset and
the database increments ids by 1.  If you are running an offset please review
all SQL updates to determine if you need to change anything in the SQL when
you apply Skyline SQL updates.</p>
</div>
<ul class="simple">
<li><p>There are changes to settings.py in v1.3.0, please ensure you diff your
current and the new settings.py as there are appended additions but there are
also additional settings that have been added to existing settings blocks.
The additions and changes described below.</p></li>
</ul>
<div class="section" id="settings-py-changes">
<h3>settings.py Changes<a class="headerlink" href="#settings-py-changes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>New settings:</p>
<ul>
<li><p><a class="reference internal" href="../skyline.html#settings.GRAPHITE_AUTH_HEADER" title="settings.GRAPHITE_AUTH_HEADER"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.GRAPHITE_AUTH_HEADER</span></code></a></p></li>
<li><p><a class="reference internal" href="../skyline.html#settings.GRAPHITE_CUSTOM_HEADERS" title="settings.GRAPHITE_CUSTOM_HEADERS"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.GRAPHITE_CUSTOM_HEADERS</span></code></a></p></li>
<li><p><a class="reference internal" href="../skyline.html#settings.GRAPHITE_RENDER_URI" title="settings.GRAPHITE_RENDER_URI"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.GRAPHITE_RENDER_URI</span></code></a></p></li>
<li><p><a class="reference internal" href="../skyline.html#settings.CARBON_HOST" title="settings.CARBON_HOST"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.CARBON_HOST</span></code></a></p></li>
<li><p><a class="reference internal" href="../skyline.html#settings.SKYLINE_FEEDBACK_NAMESPACES" title="settings.SKYLINE_FEEDBACK_NAMESPACES"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.SKYLINE_FEEDBACK_NAMESPACES</span></code></a></p></li>
<li><p><a class="reference internal" href="../skyline.html#settings.CUSTOM_ALERT_OPTS" title="settings.CUSTOM_ALERT_OPTS"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.CUSTOM_ALERT_OPTS</span></code></a></p></li>
<li><p><a class="reference internal" href="../skyline.html#settings.DOCKER" title="settings.DOCKER"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.DOCKER</span></code></a></p></li>
<li><p><a class="reference internal" href="../skyline.html#settings.DOCKER_DISPLAY_REDIS_PASSWORD_IN_REBROW" title="settings.DOCKER_DISPLAY_REDIS_PASSWORD_IN_REBROW"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.DOCKER_DISPLAY_REDIS_PASSWORD_IN_REBROW</span></code></a></p></li>
<li><p><a class="reference internal" href="../skyline.html#settings.DOCKER_FAKE_EMAIL_ALERTS" title="settings.DOCKER_FAKE_EMAIL_ALERTS"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.DOCKER_FAKE_EMAIL_ALERTS</span></code></a></p></li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.FLUX_IP</span> <span class="pre">=</span> <span class="pre">'127.0.0.1</span></code></p></li>
<li><p><a class="reference internal" href="../skyline.html#settings.FLUX_PORT" title="settings.FLUX_PORT"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.FLUX_PORT</span></code></a></p></li>
<li><p><a class="reference internal" href="../skyline.html#settings.FLUX_WORKERS" title="settings.FLUX_WORKERS"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.FLUX_WORKERS</span></code></a></p></li>
<li><p><a class="reference internal" href="../skyline.html#settings.FLUX_SELF_API_KEY" title="settings.FLUX_SELF_API_KEY"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.FLUX_SELF_API_KEY</span></code></a></p></li>
<li><p><a class="reference internal" href="../skyline.html#settings.FLUX_BACKLOG" title="settings.FLUX_BACKLOG"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.FLUX_BACKLOG</span></code></a></p></li>
<li><p><a class="reference internal" href="../skyline.html#settings.FLUX_SEND_TO_CARBON" title="settings.FLUX_SEND_TO_CARBON"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.FLUX_SEND_TO_CARBON</span></code></a></p></li>
<li><p><a class="reference internal" href="../skyline.html#settings.FLUX_CARBON_HOST" title="settings.FLUX_CARBON_HOST"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.FLUX_CARBON_HOST</span></code></a></p></li>
<li><p><a class="reference internal" href="../skyline.html#settings.FLUX_CARBON_PORT" title="settings.FLUX_CARBON_PORT"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.FLUX_CARBON_PORT</span></code></a></p></li>
<li><p><a class="reference internal" href="../skyline.html#settings.FLUX_CARBON_PICKLE_PORT" title="settings.FLUX_CARBON_PICKLE_PORT"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.FLUX_CARBON_PICKLE_PORT</span></code></a></p></li>
<li><p><a class="reference internal" href="../skyline.html#settings.FLUX_SEND_TO_STATSD" title="settings.FLUX_SEND_TO_STATSD"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.FLUX_SEND_TO_STATSD</span></code></a></p></li>
<li><p><a class="reference internal" href="../skyline.html#settings.FLUX_STATSD_HOST" title="settings.FLUX_STATSD_HOST"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.FLUX_STATSD_HOST</span></code></a></p></li>
<li><p><a class="reference internal" href="../skyline.html#settings.FLUX_STATSD_PORT" title="settings.FLUX_STATSD_PORT"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.FLUX_STATSD_PORT</span></code></a></p></li>
<li><p><a class="reference internal" href="../skyline.html#settings.VISTA_ENABLED" title="settings.VISTA_ENABLED"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.VISTA_ENABLED</span></code></a></p></li>
<li><p><a class="reference internal" href="../skyline.html#settings.VISTA_FETCHER_PROCESSES" title="settings.VISTA_FETCHER_PROCESSES"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.VISTA_FETCHER_PROCESSES</span></code></a></p></li>
<li><p><a class="reference internal" href="../skyline.html#settings.VISTA_FETCHER_PROCESS_MAX_RUNTIME" title="settings.VISTA_FETCHER_PROCESS_MAX_RUNTIME"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.VISTA_FETCHER_PROCESS_MAX_RUNTIME</span></code></a></p></li>
<li><p><a class="reference internal" href="../skyline.html#settings.VISTA_WORKER_PROCESSES" title="settings.VISTA_WORKER_PROCESSES"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.VISTA_WORKER_PROCESSES</span></code></a></p></li>
<li><p><a class="reference internal" href="../skyline.html#settings.VISTA_DO_NOT_SUBMIT_CURRENT_MINUTE" title="settings.VISTA_DO_NOT_SUBMIT_CURRENT_MINUTE"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.VISTA_DO_NOT_SUBMIT_CURRENT_MINUTE</span></code></a></p></li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.VISTA_FETCH_GRAPHITE_METRICS</span></code></p></li>
</ul>
</li>
<li><p>New Graphite related settings have been added to the main settings block,
<a class="reference internal" href="../skyline.html#settings.GRAPHITE_AUTH_HEADER" title="settings.GRAPHITE_AUTH_HEADER"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.GRAPHITE_AUTH_HEADER</span></code></a> and
<a class="reference internal" href="../skyline.html#settings.GRAPHITE_CUSTOM_HEADERS" title="settings.GRAPHITE_CUSTOM_HEADERS"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.GRAPHITE_CUSTOM_HEADERS</span></code></a> neither are enabled by default.
Additionally a <a class="reference internal" href="../skyline.html#settings.GRAPHITE_RENDER_URI" title="settings.GRAPHITE_RENDER_URI"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.GRAPHITE_RENDER_URI</span></code></a> setting has been added that
is now used in the existing and modified <a class="reference internal" href="../skyline.html#settings.GRAPH_URL" title="settings.GRAPH_URL"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.GRAPH_URL</span></code></a> setting.</p></li>
<li><p><a class="reference internal" href="../skyline.html#settings.CARBON_HOST" title="settings.CARBON_HOST"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.CARBON_HOST</span></code></a> setting has been added that defaults to
<a class="reference internal" href="../skyline.html#settings.GRAPHITE_HOST" title="settings.GRAPHITE_HOST"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.GRAPHITE_HOST</span></code></a> to enable the use of a different CARBON_HOST.</p></li>
<li><p>A new settings <a class="reference internal" href="../skyline.html#settings.SKYLINE_FEEDBACK_NAMESPACES" title="settings.SKYLINE_FEEDBACK_NAMESPACES"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.SKYLINE_FEEDBACK_NAMESPACES</span></code></a> has been added to
to reduce analysis load during busy times, read the docstring for a full
description.</p></li>
<li><p>A new setting <a class="reference internal" href="../skyline.html#settings.CUSTOM_ALERT_OPTS" title="settings.CUSTOM_ALERT_OPTS"><code class="xref py py-mod docutils literal notranslate"><span class="pre">settings.CUSTOM_ALERT_OPTS</span></code></a> allows to add custom labels,
graph titles and subjects to alerts.</p></li>
<li><p>A new Docker settings block has been added with all the Docker related
settings, the defaults these settings are for Docker not being enabled.</p></li>
<li><p>A new Flux settings block has been added for all the Flux settings</p></li>
<li><p>A new Vista settings block has been added for all the Vista settings.</p></li>
</ul>
</div>
</div>
<div class="section" id="how-to-update-from-v1-2-17">
<h2>How to update from v1.2.17<a class="headerlink" href="#how-to-update-from-v1-2-17" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Download the new release tag or clone/update to get it to a temp location,
ready to be deployed.</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">NEW_SKYLINE_VERSION</span><span class="o">=</span><span class="s2">&quot;v1.3.0&quot;</span>    <span class="c1"># Your new Skyline version</span>
<span class="nv">OLD_SKYLINE_VERSION</span><span class="o">=</span><span class="s2">&quot;v1.2.17&quot;</span>    <span class="c1"># Your old Skyline version</span>

<span class="nv">CURRENT_SKYLINE_PATH</span><span class="o">=</span><span class="s2">&quot;/opt/skyline/github/skyline&quot;</span>                 <span class="c1"># Your Skyline path</span>
<span class="nv">NEW_SKYLINE_PATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CURRENT_SKYLINE_PATH</span><span class="si">}</span><span class="s2">.</span><span class="si">${</span><span class="nv">NEW_SKYLINE_VERSION</span><span class="si">}</span><span class="s2">&quot;</span>  <span class="c1"># Your new Skyline path</span>

mkdir -p <span class="s2">&quot;</span><span class="si">${</span><span class="nv">CURRENT_SKYLINE_PATH</span><span class="si">}</span><span class="s2">.</span><span class="si">${</span><span class="nv">NEW_SKYLINE_VERSION</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nb">cd</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">CURRENT_SKYLINE_PATH</span><span class="si">}</span><span class="s2">.</span><span class="si">${</span><span class="nv">NEW_SKYLINE_VERSION</span><span class="si">}</span><span class="s2">&quot;</span>
git clone https://github.com/earthgecko/skyline .
git checkout <span class="s2">&quot;</span><span class="nv">$NEW_SKYLINE_VERSION</span><span class="s2">&quot;</span>

cp <span class="s2">&quot;</span><span class="nv">$NEW_SKYLINE_PATH</span><span class="s2">/skyline/settings.py&quot;</span> <span class="s2">&quot;</span><span class="nv">$NEW_SKYLINE_PATH</span><span class="s2">/skyline/settings.py.</span><span class="si">${</span><span class="nv">NEW_SKYLINE_VERSION</span><span class="si">}</span><span class="s2">.bak&quot;</span>

<span class="c1"># DIFF your settings.py with the new settings.py</span>
<span class="c1"># diff &quot;${CURRENT_SKYLINE_PATH}/skyline/settings.py&quot; &quot;$NEW_SKYLINE_PATH/skyline/settings.py.${NEW_SKYLINE_VERSION}.bak&quot;</span>

<span class="c1">#</span>
cat <span class="s2">&quot;</span><span class="si">${</span><span class="nv">CURRENT_SKYLINE_PATH</span><span class="si">}</span><span class="s2">/skyline/settings.py&quot;</span> &gt; <span class="s2">&quot;</span><span class="nv">$NEW_SKYLINE_PATH</span><span class="s2">/skyline/settings.py&quot;</span>

<span class="c1"># ADD the appropriate new settings to your settings file.</span>
vi <span class="s2">&quot;</span><span class="nv">$NEW_SKYLINE_PATH</span><span class="s2">/skyline/settings.py&quot;</span>

<span class="c1"># Stop Skyline DB related services</span>
<span class="nv">SKYLINE_SERVICES</span><span class="o">=</span><span class="s2">&quot;webapp</span>
<span class="s2">ionosphere</span>
<span class="s2">luminosity</span>
<span class="s2">panorama&quot;</span>
<span class="k">for</span> i in <span class="nv">$SKYLINE_SERVICES</span>
<span class="k">do</span>
  /etc/init.d/<span class="nv">$i</span> stop
<span class="k">done</span>
<span class="c1"># And stop any service controls like monit or systemd</span>

<span class="c1"># BACKUP THE DB AND APPLY THE NEW SQL</span>
<span class="nv">BACKUP_DIR</span><span class="o">=</span><span class="s2">&quot;/tmp&quot;</span>  <span class="c1"># Where you want to backup the DB to</span>
<span class="nv">MYSQL_USER</span><span class="o">=</span><span class="s2">&quot;&lt;YOUR_MYSQL_USER&gt;&quot;</span>
<span class="nv">MYSQL_HOST</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span>  <span class="c1"># Your MySQL IP</span>
<span class="nv">MYSQL_DB</span><span class="o">=</span><span class="s2">&quot;skyline&quot;</span>  <span class="c1"># Your MySQL Skyline DB name</span>

<span class="c1"># Backup DB</span>
mkdir -p <span class="nv">$BACKUP_DIR</span>
mysqldump -u<span class="nv">$MYSQL_USER</span> -p <span class="nv">$MYSQL_DB</span> &gt; <span class="nv">$BACKUP_DIR</span>/pre.<span class="nv">$NEW_SKYLINE_VERSION</span>.<span class="nv">$MYSQL_DB</span>.sql

<span class="c1"># Update DB</span>
mysql -u<span class="nv">$MYSQL_USER</span> -p <span class="nv">$MYSQL_DB</span> &lt; <span class="s2">&quot;</span><span class="si">${</span><span class="nv">NEW_SKYLINE_PATH</span><span class="si">}</span><span class="s2">/updates/sql/</span><span class="si">${</span><span class="nv">NEW_SKYLINE_VERSION</span><span class="si">}</span><span class="s2">.sql&quot;</span>

<span class="c1"># Stop all other Skyline services</span>
<span class="nv">SKYLINE_SERVICES</span><span class="o">=</span><span class="s2">&quot;horizon</span>
<span class="s2">analyzer</span>
<span class="s2">mirage</span>
<span class="s2">crucible</span>
<span class="s2">boundary</span>
<span class="s2">ionosphere</span>
<span class="s2">luminosity</span>
<span class="s2">panorama</span>
<span class="s2">webapp&quot;</span>
<span class="k">for</span> i in <span class="nv">$SKYLINE_SERVICES</span>
<span class="k">do</span>
  /etc/init.d/<span class="nv">$i</span> stop
<span class="k">done</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Move your current Skyline directory to a backup directory and move the new
Skyline v1.3.0 with your new settings.py from the temp location to your
working Skyline directory, (change your paths as appropriate) e.g.</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mv <span class="s2">&quot;</span><span class="nv">$CURRENT_SKYLINE_PATH</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">CURRENT_SKYLINE_PATH</span><span class="si">}</span><span class="s2">.</span><span class="si">${</span><span class="nv">OLD_SKYLINE_VERSION</span><span class="si">}</span><span class="s2">&quot;</span>
mv <span class="s2">&quot;</span><span class="nv">$NEW_SKYLINE_PATH</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="nv">$CURRENT_SKYLINE_PATH</span><span class="s2">&quot;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Update the dependencies</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">PYTHON_MAJOR_VERSION</span><span class="o">=</span><span class="s2">&quot;2.7&quot;</span>
<span class="nv">PYTHON_VIRTUALENV_DIR</span><span class="o">=</span><span class="s2">&quot;/opt/python_virtualenv&quot;</span>
<span class="c1"># Handle 2.7.14 and 2.7.16</span>
<span class="nv">PROJECT</span><span class="o">=</span><span class="s2">&quot;skyline-py2716&quot;</span>
<span class="k">if</span> <span class="o">[</span> ! -d <span class="s2">&quot;</span><span class="si">${</span><span class="nv">PYTHON_VIRTUALENV_DIR</span><span class="si">}</span><span class="s2">/projects/</span><span class="si">${</span><span class="nv">PROJECT</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  <span class="nv">PROJECT</span><span class="o">=</span><span class="s2">&quot;skyline-py2714&quot;</span>
<span class="k">fi</span>
<span class="nb">cd</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">PYTHON_VIRTUALENV_DIR</span><span class="si">}</span><span class="s2">/projects/</span><span class="si">${</span><span class="nv">PROJECT</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nb">source</span> bin/activate
<span class="c1"># This can take lots of minutes with the new pandas</span>
bin/<span class="s2">&quot;pip</span><span class="si">${</span><span class="nv">PYTHON_MAJOR_VERSION</span><span class="si">}</span><span class="s2">&quot;</span> install <span class="k">$(</span>cat <span class="s2">&quot;</span><span class="si">${</span><span class="nv">CURRENT_SKYLINE_PATH</span><span class="si">}</span><span class="s2">/requirements.txt&quot;</span> <span class="p">|</span> grep <span class="s2">&quot;^numpy\|^scipy\|^patsy\|^pandas&quot;</span> <span class="p">|</span> tr <span class="s1">&#39;\n&#39;</span> <span class="s1">&#39; &#39;</span><span class="k">)</span>
<span class="c1"># Remove the luminol egg as it will already be installed and pip will moan</span>
cat <span class="s2">&quot;</span><span class="si">${</span><span class="nv">CURRENT_SKYLINE_PATH</span><span class="si">}</span><span class="s2">/requirements.txt&quot;</span> <span class="p">|</span> grep -v <span class="s2">&quot;luminol&quot;</span> &gt; /tmp/requirements.txt

<span class="c1"># IF YOU ARE ON CENTOS 6 and running mainstream mysql-server-5.1 uncomment</span>
<span class="c1"># the following line and run it to fix to mysql-python-connector 8.0.6</span>
<span class="c1">#cat &quot;${CURRENT_SKYLINE_PATH}/requirements.txt&quot; | grep -v &quot;luminol\|mysql-connector-python&quot; &gt; /tmp/requirements.txt</span>

bin/<span class="s2">&quot;pip</span><span class="si">${</span><span class="nv">PYTHON_MAJOR_VERSION</span><span class="si">}</span><span class="s2">&quot;</span> install -r /tmp/requirements.txt
</pre></div>
</div>
<ul class="simple">
<li><p>Start the all Skyline services (change as appropriate for your set up) e.g.</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Start all other Skyline services</span>
<span class="nv">SKYLINE_SERVICES</span><span class="o">=</span><span class="s2">&quot;panorama</span>
<span class="s2">luminosity</span>
<span class="s2">horizon</span>
<span class="s2">analyzer</span>
<span class="s2">mirage</span>
<span class="s2">crucible</span>
<span class="s2">boundary</span>
<span class="s2">ionosphere</span>
<span class="s2">webapp&quot;</span>
<span class="k">for</span> i in <span class="nv">$SKYLINE_SERVICES</span>
<span class="k">do</span>
  /etc/init.d/<span class="nv">$i</span> start
<span class="k">done</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Check the logs</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># How are they running</span>
tail -n <span class="m">20</span> /var/log/skyline/*.log

<span class="c1"># Any errors - each app</span>
find /var/log/skyline -type f -name <span class="s2">&quot;*.log&quot;</span> <span class="p">|</span> <span class="k">while</span> <span class="nb">read</span> skyline_logfile
<span class="k">do</span>
  <span class="nb">echo</span> <span class="s2">&quot;#####</span>
<span class="s2"># Checking for errors in </span><span class="nv">$skyline_logfile</span><span class="s2">&quot;</span>
  cat <span class="s2">&quot;</span><span class="nv">$skyline_logfile</span><span class="s2">&quot;</span> <span class="p">|</span> grep -B2 -A10 -i <span class="s2">&quot;error ::\|traceback&quot;</span> <span class="p">|</span> tail -n <span class="m">60</span>
  <span class="nb">echo</span> <span class="s2">&quot;&quot;</span>
  <span class="nb">echo</span> <span class="s2">&quot;&quot;</span>
<span class="k">done</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="1_2_17.html" class="btn btn-neutral float-right" title="1.2.17" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="1_3_1.html" class="btn btn-neutral float-left" title="1.3.1" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2013-2014, Etsy Inc; 2015, Abe Stanway; 2015-2020, Gary Wilson

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>