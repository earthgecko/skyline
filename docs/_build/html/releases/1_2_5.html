

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1.2.5 - the luminosity branch &mdash; Skyline 1.2.14 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/skyline.styles.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Skyline 1.2.14 documentation" href="../index.html"/>
        <link rel="up" title="Release Notes" href="../releases.html"/>
        <link rel="next" title="1.2.4 - the luminosity branch" href="1_2_4.html"/>
        <link rel="prev" title="1.2.6 - the luminosity branch" href="1_2_6.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Skyline
          

          
          </a>

          
            
            
              <div class="version">
                1.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../requirements.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running-in-python-virtualenv.html">Running Skyline in a Python virtualenv</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../upgrading/index.html">Upgrading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-data-into-skyline.html">Getting data into Skyline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../alert-testing.html">Alert testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../monotonic-metrics.html">Strictly increasing monotonicity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../horizon.html">Horizon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analyzer.html">Analyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analyzer-optimizations.html">Analyzer Optimizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mirage.html">Mirage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../boundary.html">Boundary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../crucible.html">Crucible</a></li>
<li class="toctree-l1"><a class="reference internal" href="../panorama.html">Panorama</a></li>
<li class="toctree-l1"><a class="reference internal" href="../webapp.html">Webapp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ionosphere.html">Ionosphere</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ionosphere_echo.html">Ionosphere echo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tsfresh.html">tsfresh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../luminosity.html">Luminosity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../redis-integration.html">Redis integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running-multiple-skylines.html">Running multiple Skyline instances</a></li>
<li class="toctree-l1"><a class="reference internal" href="../skyline-and-friends.html">Skyline and friends</a></li>
<li class="toctree-l1"><a class="reference internal" href="../logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tuning-tips.html">Tuning tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tuning-tips.html#smaller-deployments">Smaller deployments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tuning-tips.html#reliability">Reliability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../monitoring-skyline.html">Monitoring Skyline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debian-and-vagrant-installation-tips.html">Debian and Vagrant Installation Tips</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../releases.html">Release Notes</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1_2_14.html">1.2.14</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_13.html">1.2.13</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_12.html">1.2.12</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_11.html">1.2.11 - the luminosity branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_10.html">1.2.10 - the luminosity branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_9.html">1.2.9 - the luminosity branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_8.html">1.2.8 - the luminosity and dawn branches</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_7.html">1.2.7 - the luminosity branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_6.html">1.2.6 - the luminosity branch</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">1.2.5 - the luminosity branch</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#changes-from-v1-2-4">Changes from v1.2.4</a></li>
<li class="toctree-l3"><a class="reference internal" href="#update-notes">Update notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-to-update-from-v1-2-2-v1-2-3-or-v1-2-4">How to update from v1.2.2, v1.2.3 or v1.2.4</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="1_2_4.html">1.2.4 - the luminosity branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_3.html">1.2.3 - the luminosity branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_2.html">1.2.2 - the luminosity branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_1.html">1.2.1 - the luminosity branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_2_0.html">1.2.0 - the luminosity branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_11.html">1.1.11 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_10.html">1.1.10 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_9.html">1.1.9 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_8.html">1.1.8 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_7.html">1.1.7 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_6.html">1.1.6 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_5.html">1.1.5 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_4.html">1.1.4 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_3.html">1.1.3 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_2.html">1.1.2 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_1.html">1.1.1 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_0.html">1.1.0 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_8.html">1.0.8 - the crucible branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_7.html">1.0.7 - the crucible branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_6.html">1.0.6 - the crucible branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_5.html">1.0.5 - the crucible branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_4.html">1.0.4 - the crucible branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_3.html">1.0.3 - the crucible branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_2.html">1.0.2 - the crucible branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_1.html">1.0.1 - the crucible branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_0.html">1.0.0 - the crucible branch</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../whats-new.html">What&#8217;s new</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../skyline.html">skyline package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Skyline</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../releases.html">Release Notes</a> &raquo;</li>
      
    <li>1.2.5 - the luminosity branch</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/releases/1_2_5.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="the-luminosity-branch">
<h1>1.2.5 - the luminosity branch<a class="headerlink" href="#the-luminosity-branch" title="Permalink to this headline">¶</a></h1>
<p>v1.2.5-luminosity - August 19, 2018</p>
<div class="section" id="changes-from-v1-2-4">
<h2>Changes from v1.2.4<a class="headerlink" href="#changes-from-v1-2-4" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">Bumped to v1.2.5-stable-luminosity</p>
</li>
<li><p class="first">Display the last 30 data points on the training_data page to inform the
operator of the Redis graph data points for comparison with any
Existing :: layers (2482)</p>
</li>
<li><p class="first">Allow user to specifically set metric as a derivative metric in training_data.
If a metric has not been analysed in terms of being a strictly monotonic
metric due to a reset of the metric, allow the operator to set this in the
training_data page and reload the graphs. (2488)</p>
</li>
<li><p class="first">Report no matches found if no matches are found, fixes #64, closes #64 (2496)</p>
</li>
<li><p class="first">Added the functionality for Skyline to send a digest alert on metrics that
stop sending data, this digest alert will only be sent once for a metric once
between ALERT_ON_STALE_PERIOD and STALE_PERIOD and a key set with the expiry
of STALE_PERIOD if the metric has been alerted on. After the STALE_PERIOD has
passed, the alert evaluation will no longer be done, ensuring that these
alerts are not noisy  (closes #67) (2492)</p>
</li>
<li><p class="first">If from=-&lt;x&gt;hours is used as a Graphite render parameter the scale is
incorrect if x hours &gt; than first retention period, passing the absolute from
and until parameter renders the graph with the correct scale for the
resolution (fixes #65 and closes #65) (2498).</p>
</li>
<li><p class="first">nonNegativeDerivative applied twice in learn.py to existing json data, with
the introduction of calculating the nonNegativeDerivative in both  Analyzer
and Mirage before the initial analysis, both apps are now passing the
preprocessed time series to the send_anomalous_metric_to function. However in
skyline/ionosphere/learn.py the metric is still being checked to determine if
it is in derivative_metrics and the nonNegativeDerivative function was being
applied to the existing json data, if the json data already exists. This was
incorrect. It is correct in the context of learn.py having to fetch the the
data from Graphite, however applying nonNegativeDerivative to existing json
data was incorrect and did not have the desired result (fixes #66 and closes #66)
(2506)</p>
</li>
<li><p class="first">Added try and except to prevent some errors that are encounter between 00:14
and 00:17 on some days (2492) #67
+        # if int(time()) - int(timeseries[-1][0]) &gt;= ALERT_ON_STALE_PERIOD:
+        # IndexError: list index out of range</p>
<blockquote>
<div><p>#68 Ionosphere validate learnt features profiles page
IssueID #2430: Ionosphere validate learnt features profiles page (#68)</p>
</div></blockquote>
</li>
<li><p class="first">Added get_features_profiles_to_validate and get_metrics_with_features_profiles_to_validate
functions to skyline/webapp/ionosphere_backend.py (2430, #68)</p>
</li>
<li><p class="first">Added validate_features_profiles.html template and added the context to the
other pages (2430, #68)</p>
</li>
<li><p class="first">Hard code IONOSPHERE_PROCESSES to 1. This variable is only declared for
the purpose of maintaining a standard set up in each module and to possibly
enable more than one processor on Ionosphere in the future, should there be a
requirement for Ionosphere to analyse the metrics quicker.  Running Ionosphere
with more than one process is untested and currently it is hard coded to be 1,
fixes #69 and closes #69 (2526)</p>
</li>
<li><p class="first">Added docs validate_features_profiles demo page resources (2430, #68)</p>
</li>
</ul>
</div>
<div class="section" id="update-notes">
<h2>Update notes<a class="headerlink" href="#update-notes" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>NOTE: If you are running v1.x you CANNOT upgrade from v1.x directly to v1.2.5</li>
<li>There is are no SQL changes with this release.</li>
<li>There are 2 additional variables added to settings.py change:
<a class="reference internal" href="../skyline.html#settings.ALERT_ON_STALE_METRICS" title="settings.ALERT_ON_STALE_METRICS"><code class="xref py py-mod docutils literal"><span class="pre">settings.ALERT_ON_STALE_METRICS</span></code></a>, <a class="reference internal" href="../skyline.html#settings.ALERT_ON_STALE_PERIOD" title="settings.ALERT_ON_STALE_PERIOD"><code class="xref py py-mod docutils literal"><span class="pre">settings.ALERT_ON_STALE_PERIOD</span></code></a>
and <a class="reference internal" href="../skyline.html#settings.DO_NOT_ALERT_ON_STALE_METRICS" title="settings.DO_NOT_ALERT_ON_STALE_METRICS"><code class="xref py py-mod docutils literal"><span class="pre">settings.DO_NOT_ALERT_ON_STALE_METRICS</span></code></a></li>
<li>There are no changes in requirements.txt</li>
</ul>
</div>
<div class="section" id="how-to-update-from-v1-2-2-v1-2-3-or-v1-2-4">
<h2>How to update from v1.2.2, v1.2.3 or v1.2.4<a class="headerlink" href="#how-to-update-from-v1-2-2-v1-2-3-or-v1-2-4" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Download the new release tag or clone/update to get it to a temp location,
ready to be deployed.</li>
<li>Diff your current running version skyline/settings.py with the new version of
skyline/settings.py and create a new settings.py in the temp location
appropriate for Skyline v1.2.5 and your set up, ready to be deployed.</li>
<li>Stop all the Skyline services and ensure any service controls such as monit,
supervisor or systemd do not start them again, (change as appropriate for
your set up) e.g.</li>
</ul>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nv">NEW_SKYLINE_VERSION</span><span class="o">=</span><span class="s2">&quot;v1.2.5-stable-luminosity&quot;</span>    <span class="c1"># Your new Skyline version</span>
<span class="nv">OLD_SKYLINE_VERSION</span><span class="o">=</span><span class="s2">&quot;v1.2.4-stable-luminosity&quot;</span>    <span class="c1"># Your old Skyline version</span>
<span class="c1"># OR</span>
<span class="c1"># OLD_SKYLINE_VERSION=&quot;v1.2.2-stable-luminosity&quot;</span>
<span class="c1"># OLD_SKYLINE_VERSION=&quot;v1.2.3-stable-luminosity&quot;</span>

<span class="nv">CURRENT_SKYLINE_PATH</span><span class="o">=</span><span class="s2">&quot;/opt/skyline/github/skyline&quot;</span>                 <span class="c1"># Your Skyline path</span>
<span class="nv">NEW_SKYLINE_PATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CURRENT_SKYLINE_PATH</span><span class="si">}</span><span class="s2">.</span><span class="si">${</span><span class="nv">NEW_SKYLINE_VERSION</span><span class="si">}</span><span class="s2">&quot;</span>  <span class="c1"># Your new Skyline path</span>

mkdir -p <span class="s2">&quot;</span><span class="si">${</span><span class="nv">CURRENT_SKYLINE_PATH</span><span class="si">}</span><span class="s2">.</span><span class="si">${</span><span class="nv">NEW_SKYLINE_VERSION</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nb">cd</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">CURRENT_SKYLINE_PATH</span><span class="si">}</span><span class="s2">.</span><span class="si">${</span><span class="nv">NEW_SKYLINE_VERSION</span><span class="si">}</span><span class="s2">&quot;</span>
git clone https://github.com/earthgecko/skyline .
git checkout <span class="s2">&quot;</span><span class="nv">$NEW_SKYLINE_VERSION</span><span class="s2">&quot;</span>

<span class="c1"># Stop all other Skyline services</span>
<span class="nv">SKYLINE_SERVICES</span><span class="o">=</span><span class="s2">&quot;horizon</span>
<span class="s2">analyzer</span>
<span class="s2">mirage</span>
<span class="s2">crucible</span>
<span class="s2">boundary</span>
<span class="s2">ionosphere</span>
<span class="s2">luminosity</span>
<span class="s2">panorama</span>
<span class="s2">webapp&quot;</span>
<span class="k">for</span> i in <span class="nv">$SKYLINE_SERVICES</span>
<span class="k">do</span>
  /etc/init.d/<span class="nv">$i</span> stop
<span class="k">done</span>
</pre></div>
</div>
<ul class="simple">
<li>Move your current Skyline directory to a backup directory and move the new
Skyline v1.2.5 with your new settings.py from the temp location to your
working Skyline directory, (change your paths as appropriate) e.g.</li>
</ul>
<div class="highlight-bash"><div class="highlight"><pre><span></span>mv /opt/skyline/github/skyline /opt/skyline/github/skyline.v1.2.4-luminosity-stable
mv <span class="s2">&quot;</span><span class="nv">$NEW_SKYLINE_PATH</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="nv">$CURRENT_SKYLINE_PATH</span><span class="s2">&quot;</span>
</pre></div>
</div>
<ul class="simple">
<li>Start the all Skyline services (change as appropriate for your set up) e.g.</li>
</ul>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># Start all other Skyline services</span>
<span class="nv">SKYLINE_SERVICES</span><span class="o">=</span><span class="s2">&quot;panorama</span>
<span class="s2">luminosity</span>
<span class="s2">horizon</span>
<span class="s2">analyzer</span>
<span class="s2">mirage</span>
<span class="s2">crucible</span>
<span class="s2">boundary</span>
<span class="s2">ionosphere</span>
<span class="s2">webapp&quot;</span>
<span class="k">for</span> i in <span class="nv">$SKYLINE_SERVICES</span>
<span class="k">do</span>
  /etc/init.d/<span class="nv">$i</span> start
<span class="k">done</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="1_2_4.html" class="btn btn-neutral float-right" title="1.2.4 - the luminosity branch" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="1_2_6.html" class="btn btn-neutral" title="1.2.6 - the luminosity branch" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013-2014, Etsy Inc; 2015, Abe Stanway; 2015-2019, Gary Wilson.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.2.14',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>