

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1.1.4 - the ionosphere branch &mdash; Skyline 1.1.9-beta documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/skyline.styles.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Skyline 1.1.9-beta documentation" href="../index.html"/>
        <link rel="up" title="Release Notes" href="../releases.html"/>
        <link rel="next" title="1.1.3 - the ionosphere branch" href="1_1_3.html"/>
        <link rel="prev" title="1.1.5 - the ionosphere branch" href="1_1_5.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Skyline
          

          
          </a>

          
            
            
              <div class="version">
                1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../requirements.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running-in-python-virtualenv.html">Running Skyline in a Python virtualenv</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../upgrading/index.html">Upgrading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-data-into-skyline.html">Getting data into Skyline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../alert-testing.html">Alert testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../monotonic-metrics.html">Strictly increasing monotonicity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../horizon.html">Horizon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analyzer.html">Analyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analyzer-optimizations.html">Analyzer Optimizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mirage.html">Mirage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../boundary.html">Boundary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../crucible.html">Crucible</a></li>
<li class="toctree-l1"><a class="reference internal" href="../panorama.html">Panorama</a></li>
<li class="toctree-l1"><a class="reference internal" href="../webapp.html">Webapp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ionosphere.html">Ionosphere</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tsfresh.html">tsfresh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../redis-integration.html">Redis integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../skyline-and-friends.html">Skyline and friends</a></li>
<li class="toctree-l1"><a class="reference internal" href="../logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tuning-tips.html">Tuning tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tuning-tips.html#smaller-deployments">Smaller deployments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tuning-tips.html#reliability">Reliability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../monitoring-skyline.html">Monitoring Skyline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debian-and-vagrant-installation-tips.html">Debian and Vagrant Installation Tips</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../releases.html">Release Notes</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1_1_9.html">1.1.9 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_8.html">1.1.8 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_7.html">1.1.7 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_6.html">1.1.6 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_5.html">1.1.5 - the ionosphere branch</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">1.1.4 - the ionosphere branch</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#upgrade-notes">Upgrade NOTES</a></li>
<li class="toctree-l3"><a class="reference internal" href="#changes">Changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="1_1_3.html">1.1.3 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_2.html">1.1.2 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_1.html">1.1.1 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_1_0.html">1.1.0 - the ionosphere branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_8.html">1.0.8 - the crucible branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_7.html">1.0.7 - the crucible branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_6.html">1.0.6 - the crucible branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_5.html">1.0.5 - the crucible branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_4.html">1.0.4 - the crucible branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_3.html">1.0.3 - the crucible branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_2.html">1.0.2 - the crucible branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_1.html">1.0.1 - the crucible branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="1_0_0.html">1.0.0 - the crucible branch</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../whats-new.html">What&#8217;s new</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../skyline.html">skyline package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Skyline</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../releases.html">Release Notes</a> &raquo;</li>
      
    <li>1.1.4 - the ionosphere branch</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/releases/1_1_4.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="the-ionosphere-branch">
<h1>1.1.4 - the ionosphere branch<a class="headerlink" href="#the-ionosphere-branch" title="Permalink to this headline">¶</a></h1>
<p>v1.1.4-beta-ionosphere - Jun 19, 2017</p>
<div class="section" id="upgrade-notes">
<h2>Upgrade NOTES<a class="headerlink" href="#upgrade-notes" title="Permalink to this headline">¶</a></h2>
<p>Any features profiles that were LEARNT prior to v1.1.4-beta-ionosphere had
their generation details added to the DB incorrectly, this needs to be fixed
in-situ against your Skyline database.  The below pattern can be used replacing
the DB user, password, etc to match you environment.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nv">BACKUP_DIR</span><span class="o">=</span><span class="s2">&quot;/tmp&quot;</span> <span class="c1"># Where you want to backup the DB to</span>
<span class="nv">MYSQL_USER</span><span class="o">=</span><span class="s2">&quot;&lt;YOUR_MYSQL_USER&gt;&quot;</span>
<span class="nv">MYSQL_PASS</span><span class="o">=</span><span class="s2">&quot;&lt;YOUR_MYSQL_PASS&gt;&quot;</span>
<span class="nv">MYSQL_HOST</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span> <span class="c1"># Your MySQL IP</span>
<span class="nv">MYSQL_DB</span><span class="o">=</span><span class="s2">&quot;skyline&quot;</span> <span class="c1"># Your MySQL Skyline DB name</span>

mkdir -p <span class="nv">$BACKUP_DIR</span>
mysqldump -u<span class="nv">$MYSQL_USER</span> -p<span class="nv">$MYSQL_PASS</span> <span class="nv">$MYSQL_DB</span> &gt; <span class="nv">$BACKUP_DIR</span>/pre.corrected.generations.dump.<span class="nv">$MYSQL_DB</span>.sql
mysql -u<span class="nv">$MYSQL_USER</span> -p<span class="nv">$MYSQL_PASS</span> -h <span class="nv">$MYSQL_HOST</span> <span class="nv">$MYSQL_DB</span> -sss -e <span class="s2">&quot;SELECT id, parent_id, generation FROM ionosphere WHERE generation &gt; 1&quot;</span> <span class="p">|</span> tr -s <span class="s1">&#39;\t&#39;</span> <span class="s1">&#39;,&#39;</span> &gt; <span class="nv">$BACKUP_DIR</span>/skyline.original.fp_ids.generations.txt
<span class="k">for</span> i_line in <span class="k">$(</span>cat <span class="nv">$BACKUP_DIR</span>/skyline.original.fp_ids.generations.txt<span class="k">)</span>
<span class="k">do</span>
  <span class="nv">FP_ID</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$i_line</span><span class="s2">&quot;</span> <span class="p">|</span> cut -d<span class="s1">&#39;,&#39;</span> -f1<span class="k">)</span>
  <span class="nv">PARENT_ID</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$i_line</span><span class="s2">&quot;</span> <span class="p">|</span> cut -d<span class="s1">&#39;,&#39;</span> -f2<span class="k">)</span>
  <span class="nv">GENERATION</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$i_line</span><span class="s2">&quot;</span> <span class="p">|</span> cut -d<span class="s1">&#39;,&#39;</span> -f3<span class="k">)</span>
  <span class="k">if</span> <span class="o">[</span> <span class="nv">$GENERATION</span> -lt <span class="m">2</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="k">continue</span>
  <span class="k">fi</span>
  <span class="nv">PARENT_GENERATION</span><span class="o">=</span><span class="k">$(</span>mysql -u<span class="nv">$MYSQL_USER</span> -p<span class="nv">$MYSQL_PASS</span> -h <span class="nv">$MYSQL_HOST</span> <span class="nv">$MYSQL_DB</span> -sss -e <span class="s2">&quot;SELECT generation FROM ionosphere WHERE id=</span><span class="nv">$PARENT_ID</span><span class="s2">&quot;</span><span class="k">)</span>
  <span class="nv">GEN_DIFF</span><span class="o">=</span><span class="k">$((</span>GENERATION-PARENT_GENERATION<span class="k">))</span>
  <span class="k">if</span> <span class="o">[</span> <span class="nv">$GEN_DIFF</span> -ne <span class="m">1</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">CORRECT_GENERATION</span><span class="o">=</span><span class="k">$((</span>PARENT_GENERATION+1<span class="k">))</span>
    <span class="nb">echo</span> <span class="s2">&quot;INCORRECT- fp_id </span><span class="nv">$FP_ID</span><span class="s2"> generation is incorrect </span><span class="nv">$GENERATION</span><span class="s2"> and parent generation is </span><span class="nv">$PARENT_GENERATION</span><span class="s2">, corrected to </span><span class="nv">$CORRECT_GENERATION</span><span class="s2">&quot;</span>
    mysql -u<span class="nv">$MYSQL_USER</span> -p<span class="nv">$MYSQL_PASS</span> -h <span class="nv">$MYSQL_HOST</span> <span class="nv">$MYSQL_DB</span> -sss -e <span class="s2">&quot;UPDATE ionosphere SET generation=</span><span class="nv">$CORRECT_GENERATION</span><span class="s2"> WHERE id=</span><span class="nv">$FP_ID</span><span class="s2">&quot;</span>
  <span class="k">fi</span>
<span class="k">done</span>
</pre></div>
</div>
</div>
<div class="section" id="changes">
<h2>Changes<a class="headerlink" href="#changes" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Some debug choices for daylight savings countdown issue
(Feature 1876: Ionosphere - training_data learn countdown)</li>
<li>Handle change in monotonicity with a check if a metric has its own Redis
z.derivative_metric key that has not expired.
(Bug 2050: analyse_derivatives - change in monotonicity)</li>
<li>Added D1 layer to features_profiles.html</li>
<li>Added D1 layer is required to ensure that layers do not inadvertently silence
true anomalies due the D layer being a singular value, a D1 layer is required
to allow the operator to mitigate against this, by setting a min and max
threshold to skip the layer. (Feature 2048: D1 ionosphere layer)</li>
<li>Allow the operator to save a training_data set with save_training_data_dir in
ionosphere_backend, etc (Feature 2054: ionosphere.save.training_data)</li>
<li>Updated docs with layers and misc modifications</li>
<li>Ionosphere - rate limiting profile learning.Rate limit Ionosphere to only
learn one profile per resolution per metric per hour. This is to stop
Ionosphere LEARNT from iteratively learning bad if something becomes anomalous
and Skyline creates lots of training data sets for a metric.  Ionosphere learn
could come along and start to incrementally increase the range in LEARNT
features profiles, with each iteration increasing a bit and going to the next
training data set another profile to match.  A spawn.c incident where
Ionosphere learnt bad and badly.
(Feature 2010: Ionosphere learn - rate limiting profile learning)</li>
<li>Ionosphere - analyse_derivatives (Feature 2034: analyse_derivatives). Add
functionality that enables Skyline apps to convert a timeseries to the
nonNegativeDerivative too properly analyse incremented count metrics. This will
allow for Ionosphere to learn these types of metrics too, as previously it could
only learn step changes at static rates as the features profiles change at every
step. NON_DERIVATIVE_MONOTONIC_METRICS setting.</li>
<li>Added matched_greater_than query to the search features profile page.  At the
moment this only covers features profiles matches not layers matches.
(Feature 1996: Ionosphere - matches page)</li>
<li>validated features profiles. Added a validated component to the features
profiles (Feature 2000: Ionosphere - validated)</li>
</ul>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="1_1_3.html" class="btn btn-neutral float-right" title="1.1.3 - the ionosphere branch" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="1_1_5.html" class="btn btn-neutral" title="1.1.5 - the ionosphere branch" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013-2014, Etsy Inc; 2015, Abe Stanway; 2015-2017, Gary Wilson.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.1.9-beta',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>