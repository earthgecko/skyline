

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Ionosphere &mdash; Skyline 1.2.14 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/skyline.styles.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Skyline 1.2.14 documentation" href="index.html"/>
        <link rel="next" title="Ionosphere echo" href="ionosphere_echo.html"/>
        <link rel="prev" title="Webapp" href="webapp.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Skyline
          

          
          </a>

          
            
            
              <div class="version">
                1.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="requirements.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="running-in-python-virtualenv.html">Running Skyline in a Python virtualenv</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="upgrading/index.html">Upgrading</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting-data-into-skyline.html">Getting data into Skyline</a></li>
<li class="toctree-l1"><a class="reference internal" href="alert-testing.html">Alert testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="monotonic-metrics.html">Strictly increasing monotonicity</a></li>
<li class="toctree-l1"><a class="reference internal" href="horizon.html">Horizon</a></li>
<li class="toctree-l1"><a class="reference internal" href="analyzer.html">Analyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="analyzer-optimizations.html">Analyzer Optimizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="mirage.html">Mirage</a></li>
<li class="toctree-l1"><a class="reference internal" href="boundary.html">Boundary</a></li>
<li class="toctree-l1"><a class="reference internal" href="crucible.html">Crucible</a></li>
<li class="toctree-l1"><a class="reference internal" href="panorama.html">Panorama</a></li>
<li class="toctree-l1"><a class="reference internal" href="webapp.html">Webapp</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Ionosphere</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#what-ionosphere-is-for-humble-beginnings">What Ionosphere is for - humble beginnings</a></li>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-well-does-it-work">How well does it work?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deploying-and-setting-ionosphere-up">Deploying and setting Ionosphere up</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ionosphere-static-demo-pages">Ionosphere static demo pages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#graphs-demo-page-multiple-resolution-graphite-graphs-for-context">Graphs demo page - multiple resolution Graphite graphs for context</a></li>
<li class="toctree-l3"><a class="reference internal" href="#features-profile-demo-page-with-matched-graphs">Features profile demo page with matched graphs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#features-profile-search-demo-page-with-generational-information">Features profile search demo page with generational information</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#still-interested">Still interested?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#things-to-consider">Things to consider</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#contextual-anomalies-earthquakes-and-earth-tremors">Contextual anomalies - Earthquakes and Earth tremors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-or-create-and-learn">&#8220;Create&#8221; or &#8220;Create and LEARN&#8221;</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bad-learnt-features-profiles">Bad LEARNT features profiles</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#how-ionosphere-works-a-simple-overview">How Ionosphere works - a simple overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-features-role">The features role</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-learning-role">The learning role</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#input">Input</a></li>
<li class="toctree-l2"><a class="reference internal" href="#features-profiles">features profiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-ionosphere-is-learning">How Ionosphere is &#8220;learning&#8221;?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#evolutionary-learning-generations">Evolutionary learning - generations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#disabled-features-profiles">DISABLED features profiles</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#layers">Layers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#matching-approximately-close">Matching approximately close</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-layers-are-defined">How layers are defined</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#no-machine-learning">No machine learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="#for-humans">For Humans</a></li>
<li class="toctree-l2"><a class="reference internal" href="#current-state">Current state</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tsfresh">tsfresh</a></li>
<li class="toctree-l2"><a class="reference internal" href="#memcached">memcached</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cached-data">Cached data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#operational-considerations">Operational considerations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#no-ui-data-update-method">No UI data update method</a></li>
<li class="toctree-l3"><a class="reference internal" href="#backup">Backup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mysql-configuration">MySQL configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ionosphere-autobuild-features-profiles-dir">Ionosphere - autobuild features_profiles dir</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ionosphere_echo.html">Ionosphere echo</a></li>
<li class="toctree-l1"><a class="reference internal" href="tsfresh.html">tsfresh</a></li>
<li class="toctree-l1"><a class="reference internal" href="luminosity.html">Luminosity</a></li>
<li class="toctree-l1"><a class="reference internal" href="redis-integration.html">Redis integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="running-multiple-skylines.html">Running multiple Skyline instances</a></li>
<li class="toctree-l1"><a class="reference internal" href="skyline-and-friends.html">Skyline and friends</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="tuning-tips.html">Tuning tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="tuning-tips.html#smaller-deployments">Smaller deployments</a></li>
<li class="toctree-l1"><a class="reference internal" href="tuning-tips.html#reliability">Reliability</a></li>
<li class="toctree-l1"><a class="reference internal" href="monitoring-skyline.html">Monitoring Skyline</a></li>
<li class="toctree-l1"><a class="reference internal" href="debian-and-vagrant-installation-tips.html">Debian and Vagrant Installation Tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="releases.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="whats-new.html">What&#8217;s new</a></li>
<li class="toctree-l1"><a class="reference internal" href="development/index.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="skyline.html">skyline package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Skyline</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Ionosphere</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/ionosphere.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ionosphere">
<h1>Ionosphere<a class="headerlink" href="#ionosphere" title="Permalink to this headline">¶</a></h1>
<p>Ionosphere is a story about time series.</p>
<p>Dedicated to my father, Derek, a man of numbers if there ever was one.</p>
<div class="section" id="what-ionosphere-is-for-humble-beginnings">
<h2>What Ionosphere is for - humble beginnings<a class="headerlink" href="#what-ionosphere-is-for-humble-beginnings" title="Permalink to this headline">¶</a></h2>
<p><strong>YOU</strong> can teach a system.</p>
<p><strong>YOU</strong> can help a system to LEARN.</p>
<p>You want to monitor metrics on small VPSs that do not do a great deal, meaning
there is no high, rate constant work or 3sigma consistency in the metrics.
There are 0 to 7 apache.sending a day, not 7000 a minute. Or there are some
peaks on the metric stats_counts.statsd.bad_lines_seen</p>
<img alt="_images/21060819.stats_counts.statsd.bad_lines_seen1.png" src="_images/21060819.stats_counts.statsd.bad_lines_seen1.png" />
<p>This is <span class="red">NOT ANOMALOUS</span></p>
<p>Even in massive, workload intensive, dynamic systems there are always some
metrics that are low rate and relatively low range.  And at 3sigma... that means
noisy.</p>
<p>Ionosphere&#8217;s goal is to allow us to train Skyline on what is not anomalous and
thereby compliment statistical 3simga means with some new methodologies of
trying to &#8220;teach&#8221; the system.  Of course teaching statistics algorithms
something new is unfortunately not possible, but luckily teaching the system is
possible.  Giving the system better contextual data to work with is the key
factor.</p>
<p>While a lot of work and research in the anomaly detection and machine learning
domain is focused at automatically finding anomalies and getting it right,
Skyline Ionosphere actually does somewhat of the opposite.</p>
<p>With Ionosphere we are training Skyline on what is NOT ANOMALOUS, rather than
focusing on what is anomalous.  Ionosphere allows us to train Skyline as to what
is normal, even if normal includes spikes and dips and seasonality.</p>
</div>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Ionosphere gives the operator an input into Skyline to allow them to train it
and compliment the existing statistical 3sigma anomaly detection methods.</li>
<li>Ionosphere then starts to learn, <strong>retrospectively</strong>.</li>
<li>Is Ionosphere the panacea for anomaly detection?  No.</li>
<li>Is Ionosphere immediately useful for web scale anomaly detection?  No.  Unless
you are already doing web scale anomaly detection with Skyline, then still no.
However over time yes.  You cannot rush time series.</li>
<li>Is Ionosphere a lot of work to train, yes.</li>
<li>Ionosphere uses a time series similarity comparison method to compare two
different time series for a metric.</li>
<li>This method is based on summing the features that are calculated for the
time series using <a href="https://github.com/blue-yonder/tsfresh" target="_blank">tsfresh</a> to &#8220;fingerprint&#8221; the data set.</li>
<li>This allows the operator to fingerprint and profile what is not anomalous, but
normal and to be expected, even if 3sigma will always detect it as anomalous.</li>
<li>Ionosphere also allows for the creation of layers rules which allow the
operator to define ad hoc boundaries and conditions that can be considered as
not anomalous for each features profile that is created.</li>
</ul>
</div>
<div class="section" id="how-well-does-it-work">
<h2>How well does it work?<a class="headerlink" href="#how-well-does-it-work" title="Permalink to this headline">¶</a></h2>
<p>This is a graph of the impact that Ionosphere has had on the anomaly count of
<cite>ionosphere_enabled</cite> metrics before and after the deployment of Ionosphere.</p>
<img alt="_images/ionosphere_impact_on_anomaly_count.png" src="_images/ionosphere_impact_on_anomaly_count.png" />
<p>It is clear that when the features profiles and layers are introduced and
Skyline starts to learn, the anomaly counts for metrics that have been trained
drop significantly, but it is not perfect.</p>
<p>Significant events which happen infrequently and change machine metrics
significantly are still difficult to handle.  Things like the occasional
importing of a DB, reboots, zipping up a bunch of things, however layers do
allow one to &#8220;describe&#8221; these events on metrics as normal should they so wish.</p>
<p>And Ionosphere does <strong>not</strong> make handling downtime and missing data points in
metrics any easier, in fact it can make it harder.</p>
<p>&#8220;Do I want to train Skyline to think that the hole in this metric for 10 hours
yesterday while OVH had 2 x 20 Kv lines down and generator problems in France,
is normal?  Maybe I should wait a week before training Skyline on any metrics
that have been OVH&#8217;d...&#8221;</p>
</div>
<div class="section" id="deploying-and-setting-ionosphere-up">
<h2>Deploying and setting Ionosphere up<a class="headerlink" href="#deploying-and-setting-ionosphere-up" title="Permalink to this headline">¶</a></h2>
<p>Requires - Panorama to be enabled and running.</p>
<p>Ionosphere has a specific section of variables in <code class="docutils literal"><span class="pre">settings.py</span></code> that are
documented in the settings specific documentation see all the settings below:</p>
<ul class="simple">
<li><a class="reference internal" href="skyline.html#settings.IONOSPHERE_CHECK_PATH" title="settings.IONOSPHERE_CHECK_PATH"><code class="xref py py-mod docutils literal"><span class="pre">settings.IONOSPHERE_CHECK_PATH</span></code></a> - <a class="reference external" href="http://earthgecko-skyline.readthedocs.io/en/latest/skyline.html#settings.IONOSPHERE_CHECK_PATH">http://earthgecko-skyline.readthedocs.io/en/latest/skyline.html#settings.IONOSPHERE_CHECK_PATH</a></li>
</ul>
<p>The Ionosphere settings follow normal Skyline settings conventions in terms of
being able to paint all metrics with certain defaults and allowing for specific
settings for specific or wildcard namespaces.  If you know Skyline then these
should all be fairly intuitive.</p>
<p>If you are new to Skyline, then by the time you have all the other Skyline apps
set up and running you should have a more intuitive feel for these to after
having spent some time looking over your running Skyline.  You cannot rush
time series :)</p>
</div>
<div class="section" id="ionosphere-static-demo-pages">
<h2>Ionosphere static demo pages<a class="headerlink" href="#ionosphere-static-demo-pages" title="Permalink to this headline">¶</a></h2>
<p>The demo pages show examples of how Ionosphere presents the operator with the
metric&#8217;s details for the specific point anomaly and the all the Graphite
metric graphs at multiple resolutions so that the operator can evaluation the
anomaly in the full context of the metric&#8217;s history.</p>
<div class="section" id="graphs-demo-page-multiple-resolution-graphite-graphs-for-context">
<h3>Graphs demo page - multiple resolution Graphite graphs for context<a class="headerlink" href="#graphs-demo-page-multiple-resolution-graphite-graphs-for-context" title="Permalink to this headline">¶</a></h3>
<p>The demo page uses an edge case anomaly one which is not easy to decide whether
it is or is not an anomaly.</p>
<p>Would <strong>YOU</strong> consider it anomalous or not?  Would you want an alert?</p>
<p>Note that this is demo page is from an older version of Ionosphere before learn
was introduced.  So it does not give the operator the 2 options:</p>
<ul class="simple">
<li>Create features profile and DO NOT LEARN</li>
<li>Create features profile and LEARN</li>
</ul>
<p>It only gives the one option, however this demo page is about the <strong>multiple
resolution Graphite graphs</strong> giving the operator context, so do not worry about
the buttons, look at the graphs, see the <span class="skyblue">Graphite ::</span> <span class="red">graphs NOW</span>
section on the below demo page.</p>
<p>See <a href="_static/ionosphere_demo/training-data-stats.gauges.statsd.timestamp_lag-20170110161506UTC/Skyline.Ionosphere.training-data-stats.gauges.statsd.timestamp_lag-20170110161506UTC.html" target="_blank">Ionosphere static multiple resolution graphs demo page</a> for a clearer picture (opens in a new browser tab).  Is
it anomalous or not anomalous?</p>
</div>
<div class="section" id="features-profile-demo-page-with-matched-graphs">
<h3>Features profile demo page with matched graphs<a class="headerlink" href="#features-profile-demo-page-with-matched-graphs" title="Permalink to this headline">¶</a></h3>
<p>This demo page shows an existing features profile with all the graph resources
that the profile was created, see the <span class="skyblue">Graphite ::</span> <span class="red">graphs WHEN created ::</span> <strong>at 7h, 24h, 7d and 30d</strong>
section in the below demo page.</p>
<p>A series of matched graphs, showing the instances where Ionosphere has
analyzed the Mirage detected anomalous time series and found it be not
anomalous because the calculated <code class="docutils literal"><span class="pre">features_sum</span></code> of the Mirage anomalous
time series were within 1% difference of the <code class="docutils literal"><span class="pre">features_sum</span> <span class="pre">::</span> <span class="pre">4764.3152004300</span></code>
that was calculated for features profile 989 see
<span class="skyblue">Graphite ::</span> <span class="red">graphs MATCHED</span> section in the below demo page.</p>
<p>See <a href="_static/ionosphere_demo/fp_matched_demo/Skyline.fp.matched.demo.html" target="_blank">Ionosphere static features profile demo page with matched graphs</a> for a clearer picture.</p>
<p>The <a href="_static/ionosphere_demo/features-profile.stats.statsd.graphiteStats.calculationtime/Skyline.Ionosphere.features-profile.stats.statsd.graphiteStats.calculationtime.html" target="_blank">old demo page with matched graphs</a>.</p>
</div>
<div class="section" id="features-profile-search-demo-page-with-generational-information">
<h3>Features profile search demo page with generational information<a class="headerlink" href="#features-profile-search-demo-page-with-generational-information" title="Permalink to this headline">¶</a></h3>
<p>See <a href="_static/ionosphere_demo/features-profile-search.stats.statsd.graphiteStats.calculationtime/Skyline.Ionosphere.features-profile-search.stats.statsd.graphiteStats.calculationtime.html" target="_blank">Ionosphere static search features profiles demo page with generation info</a> for a clearer picture with generational, parent_id,
number of times checked, number of times matched information.</p>
</div>
</div>
<div class="section" id="still-interested">
<h2>Still interested?<a class="headerlink" href="#still-interested" title="Permalink to this headline">¶</a></h2>
<img alt="_images/what_if_i_told_you_train.jpeg" src="_images/what_if_i_told_you_train.jpeg" />
<img alt="_images/what_if_i_told_you_learn.jpeg" src="_images/what_if_i_told_you_learn.jpeg" />
</div>
<div class="section" id="things-to-consider">
<h2>Things to consider<a class="headerlink" href="#things-to-consider" title="Permalink to this headline">¶</a></h2>
<div class="section" id="contextual-anomalies-earthquakes-and-earth-tremors">
<h3>Contextual anomalies - Earthquakes and Earth tremors<a class="headerlink" href="#contextual-anomalies-earthquakes-and-earth-tremors" title="Permalink to this headline">¶</a></h3>
<p>A point anomaly is only as contextually as the time frame in which it is
considered to be anomalous in.</p>
<p>The following metaphor can be used to describe this concept.  As this concept is
important to understand in terms of Ionosphere and Mirage.</p>
<p>Let us take Bob as an example, Bob lived in the UK and decided to move to
San Francisco because he landed a good job at a cool San Jose data analytics
upstart.  In the first week he is there, the Bay Area has a few Earth tremors,
to Bob from the UK this is ANOMALOUS!!! Luckily Bob has a friendly co-worker
called Alice and she directs him to <a class="reference external" href="http://earthquaketrack.com/us-ca-san-jose/recent">http://earthquaketrack.com/us-ca-san-jose/recent</a>
and shows him it is not that anomalous, it is quite normal.  Alice shows Bob to
consider the context of these events in at a fuller duration.</p>
<ul class="simple">
<li>5 earthquakes in the past 24 hours</li>
<li>5 earthquakes in the past 7 days</li>
<li>28 earthquakes in the past 30 days</li>
<li>381 earthquakes in the past 365 days</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">Bob&#8217;s Hampshire earthquake data, if there is any...</p>
</div>
<p>And the penny drops for Bob that HERE in the Bay Area this is obviously this
quite normal.</p>
<p>Bob then wonders to himself why he did not think about this before leaving
his stable shire in the UK.  He consoles himself by thinking &#8220;Well all the VCs
and players are here...&#8221; so it obviously cannot be a big single point of
failure.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">bob</span> <span class="o">=</span> <span class="s1">&#39;Skyline&#39;</span>
<span class="n">alice</span> <span class="o">=</span> <span class="s1">&#39;You&#39;</span>
</pre></div>
</div>
<p>Skyline does not know all the contexts to the data, you do.  Ionosphere lets
us teach Bob <strong>that is not an earthquake!!!</strong> and enables Bob to look and ask,
&#8220;Did Alice say this was not an earthquake, let me look&#8221;.</p>
</div>
<div class="section" id="create-or-create-and-learn">
<h3>&#8220;Create&#8221; or &#8220;Create and LEARN&#8221;<a class="headerlink" href="#create-or-create-and-learn" title="Permalink to this headline">¶</a></h3>
<p>With Ionosphere, you have the option to allow it to learn these things for
itself, as long as you tell it what it is ALLOWED to learn at the fuller
duration.</p>
<p>So Ionosphere gives you 2 options:</p>
<div class="figure" id="id1">
<img alt="_images/create.and.do.not.learn.png" src="_images/create.and.do.not.learn.png" />
<p class="caption"><span class="caption-text">Only make a features profile based on the <a class="reference internal" href="skyline.html#settings.FULL_DURATION" title="settings.FULL_DURATION"><code class="xref py py-mod docutils literal"><span class="pre">settings.FULL_DURATION</span></code></a> data or the Mirage <code class="docutils literal"><span class="pre">SECOND_ORDER_RESOLUTION_SECONDS</span></code></span></p>
</div>
<div class="figure" id="id2">
<img alt="_images/create.and.learn.png" src="_images/create.and.learn.png" />
<p class="caption"><span class="caption-text">This is not an anomaly now or then or in the forseeable future if it
looks anything like the <a class="reference internal" href="skyline.html#settings.FULL_DURATION" title="settings.FULL_DURATION"><code class="xref py py-mod docutils literal"><span class="pre">settings.FULL_DURATION</span></code></a> or any of the multiple
resolution Graphite graphs, LEARN it at the <code class="docutils literal"><span class="pre">learn_full_duration</span></code>.</span></p>
</div>
<p>This means you do not have to ship that earthquake that happened 17 days ago into
Ionosphere&#8217;s features profiles and teach it BAD, badly.  You can just tell it
to see the relevant Analyzer <a class="reference internal" href="skyline.html#settings.FULL_DURATION" title="settings.FULL_DURATION"><code class="xref py py-mod docutils literal"><span class="pre">settings.FULL_DURATION</span></code></a> or Mirage the
<code class="docutils literal"><span class="pre">SECOND_ORDER_RESOLUTION_HOURS</span></code> data as not anomalous and <strong>not</strong> learn at
the fuller duration of the metric&#8217;s <code class="docutils literal"><span class="pre">learn_full_duration</span></code>.</p>
<p>You can teach Ionosphere badly, but to unteach it is just a click of the Disable
features profile button.</p>
<p>Use Ionosphere learning sparingly, although it is a feature, it will also
generates an ongoing requirement for you to review and validate what it has
learnt.</p>
<p>Skyline learning is not perfect.  There are certain metrics that learning seems
not to work as well on as other metrics, 5min and 15min load_average metrics
fall into this category.  Do not go overboard on learning do it slowly and
incrementally.  All LEARNT features profiles have the ability to be validated,
however this is not a hard requirement, unvalidated features profiles will still
be used in analysis, the validated flag is currently simply there to give the
operation a view of what LEARNT features profiles have not been assessed to
determine their accuracy.  Skyline will also LEARN from an unvalidated features
profile.  Therefore the operator needs to review and validate or disable
features profiles every so often, this can be achieved when reviewing and
training on not anomalous patterns is done, whenever training data for a metric
is assessed it is easy to review all features profiles for that metric during
this phase by using the <span class="skyblue">Existing ::</span> <span class="red">features profiles page link</span>
on the training page and using the Ionosphere Validate page for side-by-side
comparisons.</p>
<p>To begin with try and start with only creating features profiles and only
implementing learning very occasionally when you are certain that a metric has a
very &#8220;normal&#8221; pattern over 30 days.  Initially just creating features profiles
and not trying to learn on all of them, will give you a good idea of what
Skyline Ionosphere is doing when you look at the Ionosphere matches pages and
review matches.  Having a few learn features profiles as well, will also give
you a good idea of what is being done when Skyline is learning, when you look
at the Ionosphere features profiles page and reviewing the <span class="red">learnt</span>
features profiles on the <span class="skyblue">Search ::</span> <span class="red">features profiles</span> page.</p>
</div>
<div class="section" id="bad-learnt-features-profiles">
<h3>Bad LEARNT features profiles<a class="headerlink" href="#bad-learnt-features-profiles" title="Permalink to this headline">¶</a></h3>
<p>Due to Ionosphere using a <a class="reference internal" href="skyline.html#settings.IONOSPHERE_LEARN_DEFAULT_MAX_PERCENT_DIFF_FROM_ORIGIN" title="settings.IONOSPHERE_LEARN_DEFAULT_MAX_PERCENT_DIFF_FROM_ORIGIN"><code class="xref py py-mod docutils literal"><span class="pre">settings.IONOSPHERE_LEARN_DEFAULT_MAX_PERCENT_DIFF_FROM_ORIGIN</span></code></a>
percentage difference to learn with, it is going to get some learning wrong as
far as we humans are concerned.  Due to the algorithm using a percentage
difference and not exact matches means that occasionally Ionosphere is going to
learn badly, which is often the case with load_avg metrics it seems and this
will also happen sometimes when there is missing data in a time series.
Ensure that you review and validate LEARNT features profiles often to ensure
that incorrect LEARNT features profiles are disabled as soon as possible.</p>
<p>The validate features profile page is useful for this. See
<a href="_static/ionosphere_demo/fp_validate_demo_page/validate_features_profiles.demo.html" target="_blank">Ionosphere validate features profile demo page</a></p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">A <strong>important</strong> note on learning.  When you let Ionosphere learn
you create a lot of work for yourself in terms of validating every learnt
profile that Ionosphere learns.  If Ionosphere learns badly and you do not
keep up to date with validating learnt features profiles, Ionosphere could end
up silencing genuine anomalies which you would <strong>want</strong> to be alerted on.
The minimise and mitigate Ionosphere learning badly too many times, it is
possible to set the <a class="reference internal" href="skyline.html#settings.IONOSPHERE_LEARN_DEFAULT_MAX_GENERATIONS" title="settings.IONOSPHERE_LEARN_DEFAULT_MAX_GENERATIONS"><code class="xref py py-mod docutils literal"><span class="pre">settings.IONOSPHERE_LEARN_DEFAULT_MAX_GENERATIONS</span></code></a>
variable to 2 instead of the current default of 16 (as of v1.2.5), but as a
general rule of thumb, using learning sparingly and validate often.</p>
</div>
</div>
</div>
<div class="section" id="how-ionosphere-works-a-simple-overview">
<h2>How Ionosphere works - a simple overview<a class="headerlink" href="#how-ionosphere-works-a-simple-overview" title="Permalink to this headline">¶</a></h2>
<p>Firstly one needs to understand there is a chicken and egg aspect to Ionosphere.
Which if you have read up to this point, hopefully you have already got that
point.</p>
<p>Ionosphere has a number of roles that are centered on feature extractions,
feature calculations and comparisons and a role centered on learning.</p>
<div class="section" id="the-features-role">
<h3>The features role<a class="headerlink" href="#the-features-role" title="Permalink to this headline">¶</a></h3>
<p>The features role is based on the sum of the calculated features of a time series.
What are calculated features?  Between 150 and 210 features are calculated, here
are a few examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;value__minimum&#39;</span><span class="p">,</span> <span class="s1">&#39;1507.1&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="s1">&#39;value__maximum&#39;</span><span class="p">,</span> <span class="s1">&#39;3806.75&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="s1">&#39;value__median&#39;</span><span class="p">,</span> <span class="s1">&#39;1853.95&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="s1">&#39;value__count_above_mean&#39;</span><span class="p">,</span> <span class="s1">&#39;474.0&#39;</span><span class="p">],</span>
<span class="p">[</span><span class="s1">&#39;value__skewness&#39;</span><span class="p">,</span> <span class="s1">&#39;2.1725548997&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="s1">&#39;value__number_peaks__n_3&#39;</span><span class="p">,</span> <span class="s1">&#39;121.0&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="s1">&#39;value__longest_strike_above_mean&#39;</span><span class="p">,</span> <span class="s1">&#39;42.0&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="s1">&#39;value__first_location_of_minimum&#39;</span><span class="p">,</span> <span class="s1">&#39;0.714285714286&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="s1">&#39;value__last_location_of_minimum&#39;</span><span class="p">,</span> <span class="s1">&#39;0.715277777778&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="s1">&#39;value__absolute_sum_of_changes&#39;</span><span class="p">,</span> <span class="s1">&#39;71195.65&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="s1">&#39;value__augmented_dickey_fuller&#39;</span><span class="p">,</span> <span class="s1">&#39;-5.85928430205&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="s1">&#39;value__large_number_of_peaks__n_3&#39;</span><span class="p">,</span> <span class="s1">&#39;1.0&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>For the current full list of all features that are calculated see <a class="reference internal" href="skyline.html#tsfresh_feature_names.TSFRESH_FEATURES" title="tsfresh_feature_names.TSFRESH_FEATURES"><code class="xref py py-mod docutils literal"><span class="pre">tsfresh_feature_names.TSFRESH_FEATURES</span></code></a>
Ionosphere calculates the features and then then use the sum of these values.</p>
<ul class="simple">
<li>Ionosphere <strong>only</strong> analyses SMTP alerter enabled metrics.</li>
<li>Once Ionosphere is enabled, if Analyzer or Mirage detect an anomaly on a
metric they:<ul>
<li>Save the training data set and the anomaly details</li>
<li>If the metric is not an <code class="docutils literal"><span class="pre">ionosphere_enabled</span></code> metric and a SMTP alert enabled
metric, an alert is triggered and all the created alert images are saved in
the training data directory as well.</li>
<li>If the metric is an <code class="docutils literal"><span class="pre">ionosphere_enabled</span></code> metric, Analyzer and Mirage defer
the time series to Ionosphere, via a check file, for Ionosphere to make a
decision on.  More on that below.</li>
</ul>
</li>
<li>Ionosphere serves the training data set for each triggered anomaly, ready for
a human to come along in the Webapp Ionosphere UI and say, &#8220;that is not
anomalous&#8221; (if it is not).</li>
<li>At the point the operator makes a features profile, all the features values
that are created for the not anomalous time series are entered into the
database and the metric becomes an <code class="docutils literal"><span class="pre">ionosphere_enabled</span></code> metric, if it was
not one already.</li>
<li>All the anomaly resources are then copied to the specific features profile
directory that is created for the features profile.</li>
<li>Once a metric is <code class="docutils literal"><span class="pre">ionosphere_enabled</span></code>, both Analyzer and Mirage will refer
any anomalies found for the metric to Ionosphere instead of just alerting.</li>
<li>When a 3sigma anomalous time series is sent to Ionosphere, it calculates the
features with <a href="https://github.com/blue-yonder/tsfresh" target="_blank">tsfresh</a> for the 3sigma anomalous time series and then compares
the common features sums with those of previously recorded features profiles.
If the two values are less than
<a class="reference internal" href="skyline.html#settings.IONOSPHERE_FEATURES_PERCENT_SIMILAR" title="settings.IONOSPHERE_FEATURES_PERCENT_SIMILAR"><code class="xref py py-mod docutils literal"><span class="pre">settings.IONOSPHERE_FEATURES_PERCENT_SIMILAR</span></code></a>,
Ionosphere will deem the time series as not anomalous and update the related
training data as MATCHED and update the features profile matched count in the
database.</li>
<li>If the values are not matched Ionosphere will apply Min-Max scaling (ONLY if
the features profile time series and the anomalous time series are of a
similar range) and try the same technique with temporary Min-Max scaled time
series from the original features profile time series (which is stored in the
database) and the 3sigma anomalous time series.  It creates a features profile
for each Min-Max scaled (standardized) time series and then compares the
features sums and determines whether the difference is below the
<a class="reference internal" href="skyline.html#settings.IONOSPHERE_FEATURES_PERCENT_SIMILAR" title="settings.IONOSPHERE_FEATURES_PERCENT_SIMILAR"><code class="xref py py-mod docutils literal"><span class="pre">settings.IONOSPHERE_FEATURES_PERCENT_SIMILAR</span></code></a> and
will deem it as not anomalous and update the related training data as MATCHED
and update the features profile matched count in the database.</li>
<li>If Ionosphere does <strong>not</strong> find a features profile match, it analyses the time
series against any defined layers, if there are any and if a match is found
Ionosphere will deem the time series as not anomalous and update the related
training data as MATCHED and update the features profile layers matched count
in the database.</li>
<li>If Ionosphere does <strong>not</strong> find a match, it tells the originating app
(Analyzer or Mirage) to send out the anomaly alert with a
<code class="docutils literal"><span class="pre">[Skyline</span> <span class="pre">alert]</span> <span class="pre">-</span> <span class="pre">Ionosphere</span> <span class="pre">ALERT</span></code> subject field.</li>
</ul>
</div>
<div class="section" id="the-learning-role">
<h3>The learning role<a class="headerlink" href="#the-learning-role" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Once a features profile has been made for a metric with the LEARN option, for
every unmatched anomaly that training_data is created for, after the
<code class="docutils literal"><span class="pre">learn_valid_ts_older_than</span></code> seconds have been reached, Ionosphere will
attempt to &#8220;learn&#8221; whether the anomalous event after <code class="docutils literal"><span class="pre">learn_valid_ts_older_than</span></code>
seconds and any subsequent aggregation has had time to occur, if the time series
features at <code class="docutils literal"><span class="pre">learn_full_duration</span></code> seconds match any feature profiles that
were created for the metric at the <code class="docutils literal"><span class="pre">learn_full_duration</span></code>.</li>
<li>If Ionosphere finds a match to the features calculated from the metric
time series that it surfaces from Graphite at <code class="docutils literal"><span class="pre">learn_full_duration</span></code>, it
will use the anomaly training data to create a features profile for the metric
at the metric&#8217;s <a class="reference internal" href="skyline.html#settings.FULL_DURATION" title="settings.FULL_DURATION"><code class="xref py py-mod docutils literal"><span class="pre">settings.FULL_DURATION</span></code></a> or <code class="docutils literal"><span class="pre">SECOND_ORDER_RESOLUTION_HOURS</span></code>
(whichever is applicable) <strong>and</strong> it will also create a features profile with
the <code class="docutils literal"><span class="pre">learn_full_duration</span></code> data that matched, as long as the <a class="reference internal" href="skyline.html#settings.FULL_DURATION" title="settings.FULL_DURATION"><code class="xref py py-mod docutils literal"><span class="pre">settings.FULL_DURATION</span></code></a>
or <code class="docutils literal"><span class="pre">SECOND_ORDER_RESOLUTION_HOURS</span></code> features sum difference is within the
<a class="reference internal" href="skyline.html#settings.IONOSPHERE_LEARN_DEFAULT_MAX_PERCENT_DIFF_FROM_ORIGIN" title="settings.IONOSPHERE_LEARN_DEFAULT_MAX_PERCENT_DIFF_FROM_ORIGIN"><code class="xref py py-mod docutils literal"><span class="pre">settings.IONOSPHERE_LEARN_DEFAULT_MAX_PERCENT_DIFF_FROM_ORIGIN</span></code></a> or the
metric specific <code class="docutils literal"><span class="pre">max_percent_diff_from_origin</span></code></li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Ionosphere does not currently use Min-Max scaling in the learning role,
the learnt features profiles are only created with the time series at the
original scale.</p>
</div>
</div>
</div>
<div class="section" id="input">
<h2>Input<a class="headerlink" href="#input" title="Permalink to this headline">¶</a></h2>
<p>When an anomaly alert is sent out via email, a link to the Ionosphere training
data is included in the alert.  This link opens the Ionosphere UI with the all
training data for the specific anomaly where the user can submit the metric
time series as not anomalous and have Skyline generate a features profile with
<a href="https://github.com/blue-yonder/tsfresh" target="_blank">tsfresh</a> (and optionally some additional layers, which are covered further down
on this page).</p>
</div>
<div class="section" id="features-profiles">
<h2>features profiles<a class="headerlink" href="#features-profiles" title="Permalink to this headline">¶</a></h2>
<p>When a training data set is submitted as not anomalous for a metric a features
profile is extracted from the time series using <a href="https://github.com/blue-yonder/tsfresh" target="_blank">tsfresh</a>.  This features profile
contains the values of 210 features (currently as of tsfresh-0.4.0), such
as median, mean, variance, etc, for a full list of known features that are
calculated see <a class="reference internal" href="skyline.html#tsfresh_feature_names.TSFRESH_FEATURES" title="tsfresh_feature_names.TSFRESH_FEATURES"><code class="xref py py-mod docutils literal"><span class="pre">tsfresh_feature_names.TSFRESH_FEATURES</span></code></a>.</p>
<p>This features profile is then stored in the Skyline MySQL database in the
following manner.  For every metric that has a features profile that is created,
2 MySQL InnoDB tables are created for the metric.</p>
<ul class="simple">
<li>The features profile details are inserted into the ionosphere table and the
features profile gets a unique id.</li>
<li>z_fp_&lt;metric_id&gt; - features profile metric table which contains the features
profile id, feature name id and the calculated value of the feature.</li>
<li>z_ts_&lt;metric_id&gt; - the time series data for the metric on which a features
profile was calculated.</li>
</ul>
<p>These tables are prefixed with <code class="docutils literal"><span class="pre">z_</span></code> so that they are all listed after all core
Skyline database tables.  Once a metric has a z_fp_&lt;metric_id&gt; and a
z_ts_&lt;metric_id&gt; table, these tables are updated with any future features
profiles and time series data.  So there is are 2 tables per metric, not tables
per features profile.</p>
</div>
<div class="section" id="how-ionosphere-is-learning">
<h2>How Ionosphere is &#8220;learning&#8221;?<a class="headerlink" href="#how-ionosphere-is-learning" title="Permalink to this headline">¶</a></h2>
<p>Ionosphere may have had humble beginnings, but adding this seemingly trivial
function was anything but humble, simple or easy.  So to solve the seemingly
simple problem, something completely new had to be pieced together.</p>
<p>Ionosphere &#8220;learns&#8221; time series and makes decisions based on a time series
similarities comparison method using the <a href="https://github.com/blue-yonder/tsfresh" target="_blank">tsfresh</a> package.</p>
<p>This &#8220;learning&#8221; is base upon determining the similarities in time series that
could be best described as attempting to determine how similar 2 time series are
in terms of the amount of &#8220;power/energy&#8221;, range and &#8220;movement&#8221; there is within
the time series data set.  A fingerprint or signature if you like, but understand
that neither are perfect.  This time series similarities comparison method is not
perfect in the dynamic, operational arena, but it achieves the goal of being useful.
However, it must be stated that it <strong>can</strong> be almost perfect, a <a href="https://github.com/blue-yonder/tsfresh" target="_blank">tsfresh</a> features
profile sum is (about as) <strong>perfect</strong> as you can get at 0% difference (there may
be edge cases).  However using it with 100% matching is not useful to learning
and trying to profile something like the Active Brownian Motion (for want of a
better way of explaining it).  Lots of dynamic metrics/systems will exhibit a
tendency to try an achieve Active Brownian Motion, not all but many and
definitely at differing and sometimes multiple seasonality.</p>
<p>For a very good overview of Active Brownian Motion please see the &#64;kempa-liehr
description at</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference external" href="https://github.com/blue-yonder/tsfresh/pull/143#issuecomment-272314801">https://github.com/blue-yonder/tsfresh/pull/143#issuecomment-272314801</a> -
&#8220;Dynamic systems have stable and unstable fixed points. Without noise these
systems would be driven to one of their stable fixed points and stay there for
ever. So, fixed points resemble an equilibrium state&#8221;</p>
</div>
<p>Ionosphere enables us to try and profile something similar to Active Brownian
Motion as the norm, again for want of a better way of trying to explain it.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Ionosphere does not use Min-Max scaling in the learning context</p>
</div>
<p>However, contextually, Ionosphere nor the <a href="https://github.com/blue-yonder/tsfresh" target="_blank">tsfresh</a> implemented method, will ever
be perfect, unless 2 time series have identical data, consistently, without
change.  But how challenging would that be? :)</p>
<p>Also it may be possible that an identical time series reversed may give the same
or negative of a features sum and a mirror image time series can have very
similar calculated feature sums.</p>
<p>Anyway, it is not perfect, by design.  Evolution tends to not achieve perfection,
attaining a working, functional state is usually the norm in evolution it seems.</p>
<div class="section" id="evolutionary-learning-generations">
<h3>Evolutionary learning - generations<a class="headerlink" href="#evolutionary-learning-generations" title="Permalink to this headline">¶</a></h3>
<p>Ionosphere uses an evolutionary learning model that records (and limits) the
generations of trained and learnt features profiles per metric.  Limits can be
set in <code class="docutils literal"><span class="pre">settings.py</span></code> and played around with.  For veterans of Skyline, these
tend to be much like <a class="reference internal" href="skyline.html#settings.CONSENSUS" title="settings.CONSENSUS"><code class="xref py py-mod docutils literal"><span class="pre">settings.CONSENSUS</span></code></a>, what is the correct <code class="docutils literal"><span class="pre">CONSENSUS</span></code>?</p>
<p>They are tweak and tunable.  Keep them low, you give Ionosphere less
leverage to learn.  But you will bump them up so that it can learn more and
better.</p>
<p>Although this documentation may seem overly chatty and verbose, all things have
stories.  And why should documentation be overly dull, try explaining Skyline
to someone, good luck.  You should see me at parties.  Anyway not many people
read this, so it does not really matter :)</p>
<p>If you want to understand Skyline more, look at the code.  But be gentle :)</p>
<p>Or better yet, set it up.  Being able to teach a system and see it learn it
pretty cool, just look at <a class="reference external" href="https://github.com/xviniette/FlappyLearning">https://github.com/xviniette/FlappyLearning</a>
and NeuroEvolution.js (thanks for the inspiration from &#64;nylar and &#64;xviniette)</p>
<p>Lots of Skyline concepts are easy enough to get, some are not so easy and when
they are all tied together with a splash of seasonality and a dash of
similarities, it gets quite complicated.</p>
<p>However, all Skyline pieces, individually, are relatively simple.  Seeing them
work helps or hinders depending on your outlook...
&#8220;Shit lots of stuff is anomalous&#8221; can often lead to lots of work, debugging,
fine tuning and making better or polishing a turd or diamante.</p>
</div>
<div class="section" id="disabled-features-profiles">
<h3>DISABLED features profiles<a class="headerlink" href="#disabled-features-profiles" title="Permalink to this headline">¶</a></h3>
<p>Ionosphere learning is not perfect, sometimes it will get it wrong as far as a
human is concerned.  Luckily that does not happen often, but it will happen.</p>
<p>Ionosphere lets the operator disable any features profile that they deem as
anomalous.  This can be due to a features profile having been LEARNT and the
operator thinks it to be anomalous or an operator could create a features
profile that they decide was in error, this can especially be true when on
re-evaluating after creating with the &#8220;and LEARN&#8221; option enabled, but looking at
the 30 day data and thinking... &#8220;hmmm actually I do not really want it to learn
that spike from 2 weeks ago&#8221;.</p>
<p>If a features profile is DISABLED, all its progeny features profiles are
disabled as well.  This ensures that every features profile was LEARNT from the
profile and any that were LEARNT from any of them are disabled too so that the
pattern is removed from evaluation during analysis of the metric in the future.</p>
</div>
</div>
<div class="section" id="layers">
<h2>Layers<a class="headerlink" href="#layers" title="Permalink to this headline">¶</a></h2>
<p>Ionosphere allows the operator to train Skyline a not anomalous time series
in terms of generating a features profile to be compared to anomalies in the
future, however Ionosphere also allows the operator to define &#8220;layers&#8221; rules at
the time of feature profile creation.</p>
<p>Layers rules allow us to train Skyline on boundaries as well, on the fly via the
UI at the time of features profile creation, which puts all the work for the
operator in the one place.  Think of them as metric AND feature profile specific
algorithms.  A layer should only ever be used to describe the features profile
and ONLY at <a class="reference internal" href="skyline.html#settings.FULL_DURATION" title="settings.FULL_DURATION"><code class="xref py py-mod docutils literal"><span class="pre">settings.FULL_DURATION</span></code></a> time series.  The operator should
limit their layers values to within acceptable bounds of the range within the
features profile.  The operator should not try and use a single layer to try and
describe the entire range they &#8220;think&#8221; the metric can go to, a layer is meant to
match with a features profile, not a metric, however see the Matching
approximately close section immediate below. If this methodology is followed,
layers and features profiles &#8220;retire&#8221; around the same time as metrics change
over time, an old features profile that no longer describes the current active
motion state will no longer ever be matched, neither should its layers.  One of
the things some way down the road on the Ionosphere roadmap is
Feature #1888: Ionosphere learn - evolutionary maturity forget</p>
<p>Layers were added to reduce the number of features profiles one has to train
Skyline on.  They were introduced for humans and to make it easier and more
useful.  However they come at a cost.  Every layer created reduces Ionosphere&#8217;s
opportunities to be trained and learn.  It is a compromise to save on the amount
of monkeys you have to have or need to be to train Skyline properly.  Unfortunately
someone has to be the monkey, but for every features profile/layer you create,
you create a Skyline monkey to watch that.  A monkey with fairly simple
instructions.</p>
<p>A layer consist of a series of simple algorithms that are run against a
time series after Analyzer/Mirage and Ionosphere features comparisons.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is IMPORTANT to understand that layers are only evaluated against
the <a class="reference internal" href="skyline.html#settings.FULL_DURATION" title="settings.FULL_DURATION"><code class="xref py py-mod docutils literal"><span class="pre">settings.FULL_DURATION</span></code></a> time series, regardless if it is a Mirage
metric being checked.  The operator should define their layers values in
relation to the Redis graph that is presented in the Train :: layers section
and to the Last :: 30 datapoints :: at FULL_DURATION section just below that
section, to ensure they are using relevant ranges.</p>
</div>
<div class="section" id="matching-approximately-close">
<h3>Matching approximately close<a class="headerlink" href="#matching-approximately-close" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="skyline.html#settings.IONOSPHERE_LAYERS_USE_APPROXIMATELY_CLOSE" title="settings.IONOSPHERE_LAYERS_USE_APPROXIMATELY_CLOSE"><code class="xref py py-mod docutils literal"><span class="pre">settings.IONOSPHERE_LAYERS_USE_APPROXIMATELY_CLOSE</span></code></a> variable
enables a margin of tolerance to be applied to layers D and E.  This is enabled
by default and D and E boundary limits are matched if the value is approximately
close to the limit.  This is only implemented on boundary values that are &gt; 10.
The approximately close value is calculated as 10 percent for limit values
between 11 and 29 and within 5 percent when the limit value &gt;= 30.  It is only
applied to the D layer with a &#8216;&gt;&#8217; or &#8216;&gt;=&#8217; condition and to the E layer with a
&#8216;&lt;&#8217; or &#8216;&lt;=&#8217; condition.  This makes the layers more effect and means that if a
limit on a layer is set to 52 and the data point is 53, the layer will match
and you probably want it to as well.  If approximately_close is not used you
will find it frustrating the number of times an anomaly is triggered where it
did not match a layer by small margin.</p>
</div>
<div class="section" id="how-layers-are-defined">
<h3>How layers are defined<a class="headerlink" href="#how-layers-are-defined" title="Permalink to this headline">¶</a></h3>
<p>The layers are defined as:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="n">layer</span> <span class="p">[</span><span class="n">required</span><span class="p">]</span> <span class="k">if</span> <span class="n">last_datapoint</span> <span class="p">[</span><span class="o">&lt;</span><span class="p">,</span> <span class="o">&gt;</span><span class="p">,</span> <span class="o">==</span><span class="p">,</span> <span class="o">!=</span><span class="p">,</span> <span class="o">&lt;=</span><span class="p">,</span> <span class="o">&gt;=</span><span class="p">]</span> <span class="n">x</span>
<span class="n">DISCARD</span> <span class="o">-</span> <span class="n">not_anomalous</span> <span class="kc">False</span>
</pre></div>
</div>
<p>The D layer can be used as the upper or lower limit, e.g if value &gt; x (probably
or certainly anomalous). Or this can be used if this metric operates in the
negative range or if you want it too not discard on 0 as you want to match 0,
set it to -1 or &gt; 0.1 or &gt; 1. On a high constant rate metric the D layer can be
used to discard if &lt; x so the the layer does not silence a drop.  This layer can
be complimented by the optional D1 layer below. Remember a match here disables
any of the other below layers being checked</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">D1</span> <span class="n">layer</span> <span class="p">[</span><span class="n">optional</span><span class="p">]</span> <span class="k">if</span> <span class="n">datapoint</span> <span class="p">[</span><span class="o">&lt;</span><span class="p">,</span> <span class="o">&gt;</span><span class="p">,</span> <span class="o">==</span><span class="p">,</span> <span class="o">!=</span><span class="p">,</span> <span class="o">&lt;=</span><span class="p">,</span> <span class="o">&gt;=</span><span class="p">]</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">last</span> <span class="n">y</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">time</span> <span class="n">series</span>
<span class="n">DISCARD</span> <span class="o">-</span> <span class="n">not_anomalous</span> <span class="kc">False</span>
</pre></div>
</div>
<p>The D1 layer can be used as an upper or lower limit, so the D layer does not
silence a drop.  Remember a match here disables any of the other below layer
conditions from being checked.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">E</span> <span class="n">layer</span> <span class="p">[</span><span class="n">required</span><span class="p">]</span> <span class="k">if</span> <span class="n">datapoint</span> <span class="p">[</span><span class="o">&lt;</span><span class="p">,</span> <span class="o">&gt;</span><span class="p">,</span> <span class="o">==</span><span class="p">,</span> <span class="o">!=</span><span class="p">,</span> <span class="o">&lt;=</span><span class="p">,</span> <span class="o">&gt;=</span><span class="p">]</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">last</span> <span class="n">y</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">time</span> <span class="n">series</span>
<span class="ow">not</span> <span class="n">anomalous</span>
</pre></div>
</div>
<p>The Es, F1 and F2 layers shall not be discussed as NOT IMPLEMENTED YET.</p>
<p>An example layer</p>
<p>For instance, say occasionally we can expect to see a spike of 404s status codes
on a web app due to bots or your own scanning, with layers we can tell Ionosphere
that a time series was not anomalous if the datapoint is less than 120 and has
values in the last 3 datapoints is less than 50.  This allows for a somewhat
moving window and an alert that would be delayed by say 3 minutes, but it is a
signal, rather than noise. Let us describe that layer as gt_120-5_in_3</p>
<p>To demonstrate how the above layer would work, an example of 404 counts per minute:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="n">layer</span>  <span class="p">::</span> <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="mi">120</span>                          <span class="p">::</span> <span class="p">[</span><span class="n">do</span> <span class="ow">not</span> <span class="n">check</span><span class="p">]</span>  <span class="p">::</span>  <span class="p">[</span><span class="s1">&#39;ACTIVE&#39;</span><span class="p">]</span>
<span class="n">D1</span> <span class="n">layer</span> <span class="p">::</span> <span class="k">if</span> <span class="n">value</span> <span class="n">none</span> <span class="n">none</span> <span class="ow">in</span> <span class="n">last</span> <span class="n">none</span> <span class="n">values</span>  <span class="p">::</span> <span class="p">[</span><span class="n">do</span> <span class="ow">not</span> <span class="n">check</span><span class="p">]</span>  <span class="p">::</span>   <span class="p">[</span><span class="s1">&#39;NOT ACTIVE - D1 layer not created&#39;</span><span class="p">]</span>
<span class="n">E</span> <span class="n">layer</span>  <span class="p">::</span> <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="ow">in</span> <span class="n">last</span> <span class="mi">3</span> <span class="n">values</span>           <span class="p">::</span> <span class="p">[</span><span class="n">not_anomalous</span><span class="p">,</span> <span class="k">if</span> <span class="n">active</span> <span class="n">Es</span><span class="p">,</span> <span class="n">F1</span> <span class="ow">and</span> <span class="n">F2</span> <span class="n">layers</span> <span class="n">match</span><span class="p">]</span>  <span class="p">::</span>  <span class="p">[</span><span class="s1">&#39;ACTIVE&#39;</span><span class="p">]</span>
<span class="n">Es</span> <span class="n">layer</span> <span class="p">::</span> <span class="k">if</span> <span class="n">day</span> <span class="kc">None</span> <span class="kc">None</span>                        <span class="p">::</span> <span class="p">[</span><span class="n">not_anomalous</span><span class="p">,</span> <span class="k">if</span> <span class="n">active</span> <span class="n">F1</span> <span class="ow">and</span> <span class="n">F2</span> <span class="n">layers</span> <span class="n">match</span><span class="p">]</span>  <span class="p">::</span>   <span class="p">[</span><span class="s1">&#39;NOT ACTIVE - Es layer not created&#39;</span><span class="p">]</span>
<span class="n">F1</span> <span class="n">layer</span> <span class="p">::</span> <span class="k">if</span> <span class="n">from_time</span> <span class="o">&gt;</span> <span class="kc">None</span>                     <span class="p">::</span> <span class="p">[</span><span class="n">not_anomalous</span><span class="p">,</span> <span class="k">if</span> <span class="n">active</span> <span class="n">F2</span> <span class="n">layer</span> <span class="n">matchs</span><span class="p">]</span>  <span class="p">::</span>   <span class="p">[</span><span class="s1">&#39;NOT ACTIVE - F1 layer not created&#39;</span><span class="p">]</span>
<span class="n">F2</span> <span class="n">layer</span> <span class="p">::</span> <span class="k">if</span> <span class="n">until_time</span> <span class="o">&lt;</span> <span class="kc">None</span>                    <span class="p">::</span> <span class="p">[</span><span class="n">not_anomalous</span><span class="p">]</span>  <span class="p">::</span>   <span class="p">[</span><span class="s1">&#39;NOT ACTIVE - F2 layer not created&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Apply against</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">13</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">11</span> <span class="mi">2</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">11</span> <span class="mi">0</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">11</span> <span class="mi">8</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="mi">11</span> <span class="mi">60</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span><span class="mi">11</span> <span class="mi">0</span>
</pre></div>
</div>
<p>With the above described layer, this would be classified as not anomalous,
however if the data was:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">13</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">11</span> <span class="mi">2</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">11</span> <span class="mi">0</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">11</span> <span class="mi">800</span>
</pre></div>
</div>
<p>The layer would not ever report the time series as not anomalous as the 800
exceeds the gt_120, so the rest of the layer definition would not be evaluated.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Layers may seem simple, but the layers must be thought about
carefully as it is possible for a metric to have multiple layers created on
multiple features profiles, that could silence any anomalies on the metric.
Specifically D layer, however layer D1 was added to remove this possibility,
if the layers are properly implemented.  The D1 layer is optional (and is
reverse capable with with any existing layers that were created prior to
1.1.3-beta) and is there to let the operator set upper and lower bounds where
necessary.</p>
</div>
<p>Be careful that you do not create another layer later that silences bad, e.g.
dropped to 0, the above example is not a good example of that as we want and
expect 0 on the 404 not found generally, but if it was status code 200, we would
not want any layers silencing a drop to 0, please try and use layer D1 wisely
where required.</p>
<p>However, in this example,  if you want to ensure that your 200 status code count
does not hit 0 or drop off a cliff, you would configure Boundary to watch it.</p>
</div>
</div>
<div class="section" id="no-machine-learning">
<h2>No machine learning<a class="headerlink" href="#no-machine-learning" title="Permalink to this headline">¶</a></h2>
<p>Ionosphere brings <strong>no</strong> machine learning to Skyline per se.  It is merely making
programmatic decisions based on the data it is provided with, things a human
operator tells it are not anomalous.  Ionosphere is an attempt to give Skyline
an Apollo Program refit.  Enabling the pilots to take control, have inputs.</p>
</div>
<div class="section" id="for-humans">
<h2>For Humans<a class="headerlink" href="#for-humans" title="Permalink to this headline">¶</a></h2>
<p>If Ionosphere achieves the sentiments expressed in Brian L. Troutwine &#64;bltroutwine
seminal Belgium 2014 devopsdays presentation, then it has achieved a goal.</p>
<ul class="simple">
<li>Automation with Humans in Mind: Making Complex Systems Predictable, Reliable and
Humane - <a class="reference external" href="https://legacy.devopsdays.org/events/2014-belgium/proposals/automation-with-humans-in-mind/">https://legacy.devopsdays.org/events/2014-belgium/proposals/automation-with-humans-in-mind/</a></li>
<li>video - <a class="reference external" href="http://www.ustream.tv/recorded/54703629">http://www.ustream.tv/recorded/54703629</a></li>
</ul>
<p>Ionosphere first and foremost was created to give this dimension of human
piloting where necessary.  Giving Skyline that ability to allow human input in
some from to &#8220;teach&#8221; Skyline what is not anomalous comes with a number
additional benefits, like giving the Skyline the information needed to learn
how to make decisions based on the input data it is provided within.</p>
<p>The initial goal has been achieved, but it comes at a price.  Everything has a
cost and here the cost is the operator needs to
<code class="docutils literal"><span class="pre">train_ionosphere_learn</span> <span class="pre">==</span> <span class="pre">time_in_seconds</span>&#160; <span class="pre">#</span> <span class="pre">about</span> <span class="pre">12</span> <span class="pre">seconds</span></code>.</p>
<p>Ionosphere can only be activated by the input from a human neocortex to tell it
what is not anomalous.  Some brain CPU cycles, opening emails and clicks,
assess 1 or 2 more clicks.  It is not easy, however that said it is effective at
what it set out to achieve.</p>
</div>
<div class="section" id="current-state">
<h2>Current state<a class="headerlink" href="#current-state" title="Permalink to this headline">¶</a></h2>
<p>It appears that Ionosphere is better at doing what it was intended for than
doing what it was not intended for.  All time series not being created equal.</p>
<p>Ionosphere does low range, low rate metrics very well.</p>
<p>Ionosphere does them better than high rate, highly variable metrics, when it saw
first light at least.  This is not to say that it does not do high rate, highly
variable metrics, it just needs a lot more features profiles for the metric
describing what is not anomalous. However it is possible that a larger
<a class="reference internal" href="skyline.html#settings.IONOSPHERE_LEARN_DEFAULT_MAX_PERCENT_DIFF_FROM_ORIGIN" title="settings.IONOSPHERE_LEARN_DEFAULT_MAX_PERCENT_DIFF_FROM_ORIGIN"><code class="xref py py-mod docutils literal"><span class="pre">settings.IONOSPHERE_LEARN_DEFAULT_MAX_PERCENT_DIFF_FROM_ORIGIN</span></code></a> or metric
specific <code class="docutils literal"><span class="pre">max_percent_diff_from_origin</span></code> may work quite well on large volume
and high variability metrics, time will tell.</p>
<p>Over the fullness of time and data, these learning efficiency metrics will be
available via the database data for analysis.</p>
<p><strong>UPDATE</strong> - using Min-Max scaling Ionosphere now handles high range, highly
variable metrics much better.</p>
</div>
<div class="section" id="tsfresh">
<h2>tsfresh<a class="headerlink" href="#tsfresh" title="Permalink to this headline">¶</a></h2>
<p>The <a href="https://github.com/blue-yonder/tsfresh" target="_blank">tsfresh</a> package and features extraction functions, enabled this ability of
features calculation on a wholesale scale, without having to design lots of
algorithms to calculate the time series features for.  The <a href="https://github.com/blue-yonder/tsfresh" target="_blank">tsfresh</a> package
enabled Ionosphere to happen much FASTER, it calculates all the features that
are required to make this method viable and work.  They said:</p>
<p><code class="docutils literal"><span class="pre">&quot;Spend</span> <span class="pre">less</span> <span class="pre">time</span> <span class="pre">on</span> <span class="pre">feature</span> <span class="pre">engineering&quot;</span></code></p>
<p>They were not wrong.  Skyline has added a lot of &#8220;checks&#8221; to ensure consistency
in the <a href="https://github.com/blue-yonder/tsfresh" target="_blank">tsfresh</a> calculated features so that a features profile is not affected
by any changes that may be implemented in the <a href="https://github.com/blue-yonder/tsfresh" target="_blank">tsfresh</a> package.  All of this
has been pushed back into <a href="https://github.com/blue-yonder/tsfresh" target="_blank">tsfresh</a> and may be one of the reasons why the actual
development of Ionosphere took so long, but you cannot rush time series.</p>
<p>This overview of Ionosphere could not be complete without a special thanks to
the <a href="https://github.com/blue-yonder/tsfresh" target="_blank">tsfresh</a> people &#64;MaxBenChrist, &#64;nils-braun and &#64;jneuff who are some of nicest
people in open source, on par with &#64;astanway :)</p>
<p>Thanks to <a href="https://www.blue-yonder.com" target="_blank">blue-yonder</a> for supporting the open sourcing of <a href="https://github.com/blue-yonder/tsfresh" target="_blank">tsfresh</a>.</p>
</div>
<div class="section" id="memcached">
<h2>memcached<a class="headerlink" href="#memcached" title="Permalink to this headline">¶</a></h2>
<p>Ionosphere uses memcached and pymemcache (see <a class="reference external" href="https://github.com/pinterest/pymemcache">https://github.com/pinterest/pymemcache</a>)
to cache some DB data.  This optimises DB usage and ensures that any large
anomalous event does not result in Ionosphere making all the DB metrics become
anomalous :)</p>
<p>The architectural decision to introduce memcached when Redis is already
available, was done to ensure that Redis is for time series data (and alert keys)
and memcached isolates DB data caching.  The memcache data is truly transient,
where as the Redis data is more persistent data and memcached is a mature, easy
to use and well documented.</p>
<div class="section" id="cached-data">
<h3>Cached data<a class="headerlink" href="#cached-data" title="Permalink to this headline">¶</a></h3>
<p>Ionosphere caches the following data:</p>
<ul class="simple">
<li>features profile features values from the <cite>z_fp_&lt;metric_id&gt;</cite> table - no expiry</li>
<li>metrics table metric record - <cite>expire=3600</cite></li>
<li>metric feature profile ids - <cite>expire=3600</cite></li>
<li>features profile features time series from the <cite>z_ts_&lt;metric_id&gt;</cite> table - no
expiry</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">due to caching a metric and a features profile can take up to 1 hour
to become live.</p>
</div>
</div>
</div>
<div class="section" id="operational-considerations">
<h2>Operational considerations<a class="headerlink" href="#operational-considerations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="no-ui-data-update-method">
<h3>No UI data update method<a class="headerlink" href="#no-ui-data-update-method" title="Permalink to this headline">¶</a></h3>
<p>There is no method to modify the DB data via the UI.  If you want to make any
changes, they must be made directly against the DB.  Deleting features profiles,
changing any of the metrics values once set for metrics e.g.
<code class="docutils literal"><span class="pre">learn_full_duration</span></code>, <code class="docutils literal"><span class="pre">learn_valid_ts_older_than</span></code>, <code class="docutils literal"><span class="pre">max_generations</span></code> or
<code class="docutils literal"><span class="pre">max_percent_diff_from_origin</span></code></p>
</div>
<div class="section" id="backup">
<h3>Backup<a class="headerlink" href="#backup" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Backup the MySQL DB to another machine or better slave it and backup the slave.</li>
<li>rsync backup /opt/skyline/ionosphere/features_profiles to another machine,
frequently (for the time being, until autobuild is available, however
autobuild will not a able to recreate all the resources, but most).</li>
</ul>
</div>
<div class="section" id="mysql-configuration">
<h3>MySQL configuration<a class="headerlink" href="#mysql-configuration" title="Permalink to this headline">¶</a></h3>
<p>There could be a lot of tables. <strong>DEFINITELY</strong> implement <code class="docutils literal"><span class="pre">innodb_file_per_table</span></code>
in MySQL.</p>
</div>
</div>
<div class="section" id="ionosphere-autobuild-features-profiles-dir">
<h2>Ionosphere - autobuild features_profiles dir<a class="headerlink" href="#ionosphere-autobuild-features-profiles-dir" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">autobuild - TBD at some point in the future, for now see the Backup
section above.</p>
</div>
<p>The number of features_profiles dirs that Ionosphere learn could spawn and the
amount of data storage that would result is unknown. It is possible the operator
is going to need to prune this data a lot of which will probably never be looked
at. Or a Skyline node is going to fail, not have the features_profiles dirs
backed up and all the data is going to be lost or deleted. So it is possible for
Ionosphere to created all the human interrupted resources for the features
profile back under a best effort methodology. Although the original Redis graph
image would not be available, nor the Graphite graphs in the resolution at which
the features profile was created, however the fp_ts is available so the Redis
plot could be remade and all the Graphite graphs could be made as best effort
with whatever resolution is available for that time period.</p>
<p>This allows the operator to delete/prune feature profile dirs by possibly least
matched by age, etc or all and still be able to surface the available features
profile page data on-demand.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">expire features profiles older than?  Ionosphere forget.</p>
</div>
<p>See <a class="reference external" href="development/ionosphere.html">Development - Ionosphere</a></p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ionosphere_echo.html" class="btn btn-neutral float-right" title="Ionosphere echo" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="webapp.html" class="btn btn-neutral" title="Webapp" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013-2014, Etsy Inc; 2015, Abe Stanway; 2015-2019, Gary Wilson.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.2.14',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>